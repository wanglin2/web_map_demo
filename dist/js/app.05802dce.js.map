{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Old.vue?22cd","webpack:///./src/App.vue","webpack:///./src/Old.vue","webpack:///./src/utils.js","webpack:///./src/Old.vue?68a3","webpack:///./src/New.vue","webpack:///./src/New.vue?648e","webpack:///./src/App.vue?6697","webpack:///./src/main.js","webpack:///./src/New.vue?8fcd","webpack:///./src/App.vue?ab82"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","comp","ref","onMousedown","center","angleToRad","angle","Math","PI","radToAngle","rad","EARTH_RAD","lngLat2Mercator","lng","lat","x","sin","y","log","mercatorToLngLat","atan","exp","EARTH_PERIMETER","TILE_SIZE","getResolution","tileNums","pow","tileTotalPx","resolutions","transformXY","getTileRowAndCol","z","resolution","row","floor","col","getPxFromLngLat","_x","_y","getTileUrl","domainIndexList","domainIndex","random","KEY","ctx","zoom","shouldRender","this","url","cacheKey","img","loaded","timer","createUrl","load","Image","src","setTimeout","onload","clearTimeout","render","drawImage","width","height","isMousedown","tileCache","currentTileCache","minZoom","maxZoom","lastZoom","scale","scaleTmp","playback","mounted","initCanvas","renderTiles","addEventListener","onMousemove","onMouseup","onMousewheel","beforeUnmount","removeEventListener","methods","$refs","map","getBoundingClientRect","canvas","getContext","translate","centerTile","centerTilePos","centerPos","offset","rowMinNum","ceil","colMinNum","rowMaxNum","colMaxNum","updatePos","clear","clearRect","e","which","mx","movementX","my","movementY","deltaY","stop","from","to","onUpdate","latest","save","keys","forEach","tile","restore","onComplete","__exports__","type","placeholder","searchText","onSearch","searchResultList","item","index","go","location","posValue","onChangePos","backCenter","zoomIn","zoomOut","layer","opacity","fadeInDuration","image","isFadeIn","add","hide","fadeIn","base","anim","Animation","frame","time","start","initCenter","stage","layer1","layer2","useLayer1","searchTimer","translateTmp","translatePlayback","watch","val","join","init","fetch","response","json","res","arr","rectangle","split","pos1","pos2","Number","console","mapBox","Stage","container","Layer","updateLayer","clearLayer","removeChildren","resetLayer","currentLayer","willLayer","zIndex","scaleMap","trim","then","tips","newCenter","newCenterMercator","centerMercator","duration","components","New","Old","createApp","App","mount"],"mappings":"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","file":"js/app.05802dce.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Old.vue?vue&type=style&index=0&id=e1a8d70c&scoped=true&lang=css\"","<template>\n  <div class=\"app\">\n    <div class=\"mapContainer\">\n      <component :is=\"comp\"></component>\n    </div>\n    <div class=\"btnGroup\">\n      <div\n        class=\"btn\"\n        :class=\"{ active: this.comp === 'New' }\"\n        @click=\"this.comp = 'New'\"\n      >\n        优化版\n      </div>\n      <div\n        class=\"btn\"\n        :class=\"{ active: this.comp === 'Old' }\"\n        @click=\"this.comp = 'Old'\"\n      >\n        原始版\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Old from \"./Old\";\nimport New from \"./New\";\n\nexport default {\n  components: {\n    New,\n    Old,\n  },\n  data() {\n    return {\n      comp: \"New\",\n    };\n  },\n};\n</script>\n\n<style scoped>\n.btnGroup {\n  position: fixed;\n  left: 50%;\n  transform: translateX(-50%);\n  bottom: 50px;\n  display: flex;\n  height: 30px;\n  background-color: #fff;\n  border: 1px solid #b3b3b3;\n  border-radius: 5px;\n  overflow: hidden;\n  line-height: 30px;\n  cursor: pointer;\n}\n\n.btn {\n  padding: 0 16px;\n}\n\n.btn.active {\n  background-color: #e0e0e0;\n}\n</style>","<template>\n  <div class=\"map\" ref=\"map\">\n    <canvas ref=\"canvas\" @mousedown=\"onMousedown\"></canvas>\n    <div class=\"center\">{{ this.center[0] + \",\" + this.center[1] }}</div>\n    <div class=\"line lineX\"></div>\n    <div class=\"line lineY\"></div>\n  </div>\n</template>\n\n<script>\nimport { animate } from \"popmotion\";\nimport {\n  getTileUrl,\n  TILE_SIZE,\n  getTileRowAndCol,\n  lngLat2Mercator,\n  getPxFromLngLat,\n  resolutions,\n  mercatorToLngLat,\n} from \"./utils\";\n\n// 瓦片类\nclass Tile {\n  constructor({ ctx, row, col, zoom, x, y, shouldRender }) {\n    // 画布上下文\n    this.ctx = ctx;\n    // 瓦片行列号\n    this.row = row;\n    this.col = col;\n    // 瓦片层级\n    this.zoom = zoom;\n    // 显示位置\n    this.x = x;\n    this.y = y;\n    // 判断瓦片是否应该渲染\n    this.shouldRender = shouldRender;\n    // 瓦片url\n    this.url = \"\";\n    // 缓存key\n    this.cacheKey = this.row + \"_\" + this.col + \"_\" + this.zoom;\n    // 图片\n    this.img = null;\n    // 图片是否加载完成\n    this.loaded = false;\n    // 图片加载超时定时器\n    this.timer = null;\n\n    this.createUrl();\n    this.load();\n  }\n\n  // 生成url\n  createUrl() {\n    this.url = getTileUrl(this.row, this.col, this.zoom);\n  }\n\n  // 加载图片\n  load() {\n    this.img = new Image();\n    this.img.src = this.url;\n    // 加载超时，重新加载\n    this.timer = setTimeout(() => {\n      this.createUrl();\n      this.load();\n    }, 1000);\n    this.img.onload = () => {\n      clearTimeout(this.timer);\n      this.loaded = true;\n      this.render();\n    };\n  }\n\n  // 将图片渲染到canvas上\n  render() {\n    if (!this.loaded || !this.shouldRender(this.cacheKey)) {\n      return;\n    }\n    this.ctx.drawImage(this.img, this.x, this.y);\n  }\n\n  // 更新位置\n  updatePos(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n}\n\nexport default {\n  name: \"App\",\n  data() {\n    return {\n      // 画布宽高\n      width: 0,\n      height: 0,\n      // 鼠标按下标志\n      isMousedown: false,\n      // 缓存瓦片实例\n      tileCache: {},\n      // 记录当前画布上需要的瓦片\n      currentTileCache: {},\n      // 初始中心经纬度\n      center: [120.148732, 30.231006], // 雷锋塔\n      // 初始缩放层级\n      zoom: 17,\n\n      // 缩放层级范围\n      minZoom: 3,\n      maxZoom: 18,\n      // canvas绘图上下文\n      ctx: null,\n      // 缩放相关\n      lastZoom: 0,\n      scale: 1,\n      scaleTmp: 1,\n      playback: null,\n    };\n  },\n  mounted() {\n    this.initCanvas();\n    this.renderTiles();\n    window.addEventListener(\"mousemove\", this.onMousemove);\n    window.addEventListener(\"mouseup\", this.onMouseup);\n    window.addEventListener(\"wheel\", this.onMousewheel);\n  },\n  beforeUnmount() {\n    window.removeEventListener(\"mousemove\", this.onMousemove);\n    window.removeEventListener(\"mouseup\", this.onMouseup);\n    window.removeEventListener(\"wheel\", this.onMousewheel);\n  },\n  methods: {\n    // 初始化画布\n    initCanvas() {\n      // 获取容器宽高\n      let { width, height } = this.$refs.map.getBoundingClientRect();\n      this.width = width;\n      this.height = height;\n      // 设置画布宽高\n      let canvas = this.$refs.canvas;\n      canvas.width = this.width;\n      canvas.height = this.height;\n      this.ctx = canvas.getContext(\"2d\");\n      // 移动画布原点\n      this.ctx.translate(this.width / 2, this.height / 2);\n    },\n\n    // 计算显示范围内的瓦片行列号\n    renderTiles() {\n      // 中心点对应的瓦片\n      let centerTile = getTileRowAndCol(\n        ...lngLat2Mercator(...this.center),\n        this.zoom\n      );\n      // 中心瓦片左上角对应的像素坐标\n      let centerTilePos = [\n        centerTile[0] * TILE_SIZE,\n        centerTile[1] * TILE_SIZE,\n      ];\n      // 中心点对应的像素坐标\n      let centerPos = getPxFromLngLat(...this.center, this.zoom);\n      // 中心像素坐标距中心瓦片左上角的差值\n      let offset = [\n        centerPos[0] - centerTilePos[0],\n        centerPos[1] - centerTilePos[1],\n      ];\n      // 计算瓦片数量\n      let rowMinNum = Math.ceil((this.width / 2 - offset[0]) / TILE_SIZE);\n      let colMinNum = Math.ceil((this.height / 2 - offset[1]) / TILE_SIZE);\n      let rowMaxNum = Math.ceil(\n        (this.width / 2 - (TILE_SIZE - offset[0])) / TILE_SIZE\n      );\n      let colMaxNum = Math.ceil(\n        (this.height / 2 - (TILE_SIZE - offset[1])) / TILE_SIZE\n      );\n      // 渲染画布内所有瓦片\n      this.currentTileCache = {}; // 清空缓存对象\n      for (let i = -rowMinNum; i <= rowMaxNum; i++) {\n        for (let j = -colMinNum; j <= colMaxNum; j++) {\n          // 当前瓦片的行列号\n          let row = centerTile[0] + i;\n          let col = centerTile[1] + j;\n          // 当前瓦片的显示位置\n          let x = i * TILE_SIZE - offset[0];\n          let y = j * TILE_SIZE - offset[1];\n          // 缓存key\n          let cacheKey = row + \"_\" + col + \"_\" + this.zoom;\n          // 记录当前需要的瓦片\n          this.currentTileCache[cacheKey] = true;\n          // 该瓦片已加载过\n          if (this.tileCache[cacheKey]) {\n            this.tileCache[cacheKey].updatePos(x, y).render();\n          } else {\n            // 未加载过\n            this.tileCache[cacheKey] = new Tile({\n              ctx: this.ctx,\n              row,\n              col,\n              zoom: this.zoom,\n              x,\n              y,\n              // 判断瓦片是否在当前画布缓存对象上，是的话则代表需要渲染\n              shouldRender: (key) => {\n                return this.currentTileCache[key];\n              },\n            });\n          }\n        }\n      }\n    },\n\n    // 清除画布\n    clear() {\n      this.ctx.clearRect(\n        -this.width / 2,\n        -this.height / 2,\n        this.width,\n        this.height\n      );\n    },\n\n    // 鼠标按下\n    onMousedown(e) {\n      if (e.which === 1) {\n        this.isMousedown = true;\n      }\n    },\n\n    // 鼠标移动\n    onMousemove(e) {\n      if (!this.isMousedown) {\n        return;\n      }\n      // 计算本次拖动的距离对应的经纬度数据\n      let mx = e.movementX * resolutions[this.zoom];\n      let my = e.movementY * resolutions[this.zoom];\n      let [x, y] = lngLat2Mercator(...this.center);\n      // 更新拖动后的中心点经纬度\n      this.center = mercatorToLngLat(x - mx, my + y);\n      // 清除画布重新渲染瓦片\n      this.clear();\n      this.renderTiles();\n    },\n\n    // 鼠标松开\n    onMouseup() {\n      this.isMousedown = false;\n    },\n\n    // 鼠标滚动\n    onMousewheel(e) {\n      if (e.deltaY > 0) {\n        // 层级变小\n        if (this.zoom > this.minZoom) this.zoom--;\n      } else {\n        // 层级变大\n        if (this.zoom < this.maxZoom) this.zoom++;\n      }\n      // 层级未发生改变\n      if (this.lastZoom === this.zoom) {\n        return;\n      }\n      this.lastZoom = this.zoom;\n      // 更新缩放比例，也就是目标缩放值\n      this.scale *= e.deltaY > 0 ? 0.5 : 2;\n      // 停止上一次动画\n      if (this.playback) {\n        this.playback.stop();\n      }\n      // 开启动画\n      this.playback = animate({\n        from: this.scaleTmp, // 当前缩放值\n        to: this.scale, // 目标缩放值\n        onUpdate: (latest) => {\n          // 实时更新当前缩放值\n          this.scaleTmp = latest;\n          // 保存画布之前状态，原因有二：\n          // 1.scale方法是会在之前的状态上叠加的，比如初始是1，第一次执行scale(2,2)，第二次执行scale(3,3)，最终缩放值不是3，而是6，所以每次缩放完就恢复状态，那么就相当于每次都是从初始值1开始缩放，效果就对了\n          // 2.保证缩放效果只对重新渲染已有瓦片生效，不会对最后的renderTiles()造成影响\n          this.ctx.save();\n          this.clear();\n          this.ctx.scale(latest, latest);\n          // 刷新当前画布上的瓦片\n          Object.keys(this.currentTileCache).forEach((tile) => {\n            this.tileCache[tile].render();\n          });\n          // 恢复到画布之前状态\n          this.ctx.restore();\n        },\n        onComplete: () => {\n          // 动画完成后将缩放值重置为1\n          this.scale = 1;\n          this.scaleTmp = 1;\n          // 根据最终缩放值重新计算需要的瓦片并渲染\n          this.renderTiles();\n        },\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.map {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n\n.line {\n  position: absolute;\n  background-color: #000;\n}\n\n.lineX {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  width: 50px;\n  height: 2px;\n}\n\n.lineY {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  height: 50px;\n  width: 2px;\n}\n\n.center {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translateX(-50%);\n}\n</style>","// 角度转弧度\nconst angleToRad = (angle) => {\n    return angle * (Math.PI / 180)\n}\n\n// 弧度转角度\nconst radToAngle = (rad) => {\n    return rad * (180 / Math.PI)\n}\n\n// 地球半径\nconst EARTH_RAD = 6378137\n\n// 4326转3857\nexport const lngLat2Mercator = (lng, lat) => {\n    // 经度先转弧度，然后因为 弧度 = 弧长 / 半径 ，得到弧长为 弧长 = 弧度 * 半径\n    let x = angleToRad(lng) * EARTH_RAD\n    // 纬度先转弧度\n    let rad = angleToRad(lat)\n    // 下面我就看不懂了\n    let sin = Math.sin(rad)\n    let y = (EARTH_RAD / 2) * Math.log((1 + sin) / (1 - sin))\n    return [x, y]\n}\n\n// 3857转4326\nexport const mercatorToLngLat = (x, y) => {\n    let lng = radToAngle(x) / EARTH_RAD\n    let lat = radToAngle(2 * Math.atan(Math.exp(y / EARTH_RAD)) - Math.PI / 2)\n    return [lng, lat]\n}\n\n// 地球周长\nconst EARTH_PERIMETER = 2 * Math.PI * EARTH_RAD\n// 瓦片像素\nexport const TILE_SIZE = 256\n\n// 获取某一层级下的分辨率\nexport const getResolution = (n) => {\n    const tileNums = Math.pow(2, n)\n    const tileTotalPx = tileNums * TILE_SIZE\n    return EARTH_PERIMETER / tileTotalPx\n}\n\n// 分辨率列表\nexport const resolutions = []\nfor (let i = 0; i <= 18; i++) {\n    resolutions.push(getResolution(i))\n}\n\n// 转换3857坐标的原点\nexport const transformXY = (x, y) => {\n    x += EARTH_PERIMETER / 2\n    y = EARTH_PERIMETER / 2 - y\n    return [x, y]\n}\n\n// 根据3857坐标及缩放层级计算瓦片行列号\nexport const getTileRowAndCol = (x, y, z) => {\n    let t = transformXY(x, y)\n    x = t[0]\n    y = t[1]\n    let resolution = resolutions[z]\n    let row = Math.floor(x / resolution / TILE_SIZE)\n    let col = Math.floor(y / resolution / TILE_SIZE)\n    return [row, col]\n}\n\n// 计算4326经纬度对应的像素坐标\nexport const getPxFromLngLat = (lng, lat, z) => {\n    let [_x, _y] = transformXY(...lngLat2Mercator(lng, lat))\n    let resolution = resolutions[z]\n    let x = Math.floor(_x / resolution)\n    let y = Math.floor(_y / resolution)\n    return [x, y]\n}\n\n// 拼接瓦片地址\nexport const getTileUrl = (x, y, z) => {\n    let domainIndexList = [1, 2, 3, 4]\n    let domainIndex =\n        domainIndexList[Math.floor(Math.random() * domainIndexList.length)]\n    return `https://webrd0${domainIndex}.is.autonavi.com/appmaptile?x=${x}&y=${y}&z=${z}&lang=zh_cn&size=1&scale=1&style=8`\n}\n\nexport const KEY = '0913a20b5d5a703b920e1ff0d9d26559'","import { render } from \"./Old.vue?vue&type=template&id=e1a8d70c&scoped=true\"\nimport script from \"./Old.vue?vue&type=script&lang=js\"\nexport * from \"./Old.vue?vue&type=script&lang=js\"\n\nimport \"./Old.vue?vue&type=style&index=0&id=e1a8d70c&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/linwang/Documents/lxqnsys/web_map_demo/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e1a8d70c\"]])\n\nexport default __exports__","<template>\n  <div class=\"map\" ref=\"map\">\n    <div class=\"mapBox\" ref=\"mapBox\" @mousedown=\"onMousedown\"></div>\n    <!-- 中心点十字架 -->\n    <div class=\"line lineX\"></div>\n    <div class=\"line lineY\"></div>\n    <!-- 搜索框 -->\n    <div class=\"searchBox\">\n      <div class=\"searchInput\">\n        <input\n          type=\"text\"\n          placeholder=\"搜索...\"\n          v-model=\"searchText\"\n          @input=\"onSearch\"\n          @keyup.enter=\"onSearch\"\n        />\n      </div>\n      <div class=\"searchList\">\n        <div\n          class=\"searchItem\"\n          v-for=\"(item, index) in searchResultList\"\n          :key=\"index\"\n          @click=\"go(item.location)\"\n        >\n          {{ item.name }}\n        </div>\n      </div>\n    </div>\n    <!-- 经纬度框 -->\n    <div class=\"posInput\">\n      <input\n        type=\"text\"\n        placeholder=\"经纬度...\"\n        v-model=\"posValue\"\n        @keyup.enter=\"onChangePos\"\n      />\n    </div>\n    <!-- 返回到初始中心点按钮 -->\n    <div class=\"backCenterBtn\" @click=\"backCenter\"></div>\n    <!-- 放大缩小按钮 -->\n    <div class=\"scaleBtnBox\">\n      <div class=\"scaleBtn in\" :class=\"{disabled: zoom >= maxZoom}\" @click=\"zoomIn\"></div>\n      <div class=\"scaleBtn out\" :class=\"{disabled: zoom <= minZoom}\" @click=\"zoomOut\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { animate } from \"popmotion\";\nimport Konva from \"konva\";\nimport {\n  getTileUrl,\n  TILE_SIZE,\n  getTileRowAndCol,\n  lngLat2Mercator,\n  getPxFromLngLat,\n  resolutions,\n  mercatorToLngLat,\n  KEY,\n} from \"./utils\";\n\n// 瓦片类\nclass Tile {\n  constructor({ layer, row, col, zoom, x, y, shouldRender }) {\n    // 瓦片显示图层\n    this.layer = layer;\n    // 瓦片行列号\n    this.row = row;\n    this.col = col;\n    // 瓦片层级\n    this.zoom = zoom;\n    // 显示位置\n    this.x = x;\n    this.y = y;\n    // 判断瓦片是否应该渲染\n    this.shouldRender = shouldRender;\n    // 瓦片url\n    this.url = \"\";\n    // 缓存key\n    this.cacheKey = this.row + \"_\" + this.col + \"_\" + this.zoom;\n    // 瓦片图片\n    this.img = null;\n    // 瓦片透明度\n    this.opacity = 0;\n    // 图片是否加载完成\n    this.loaded = false;\n    // 图片加载超时定时器\n    this.timer = null;\n    // 瓦片渐现过渡时间\n    this.fadeInDuration = 500;\n\n    this.createUrl();\n    this.load();\n  }\n\n  // 生成url\n  createUrl() {\n    this.url = getTileUrl(this.row, this.col, this.zoom);\n  }\n\n  // 加载图片\n  load() {\n    let img = new Image();\n    img.src = this.url;\n    // 加载超时，重新加载\n    this.timer = setTimeout(() => {\n      this.createUrl();\n      this.load();\n    }, 1000);\n    // 加载完成\n    img.onload = () => {\n      clearTimeout(this.timer);\n      // 创建图片元素\n      this.img = new Konva.Image({\n        image: img,\n        width: TILE_SIZE,\n        height: TILE_SIZE,\n        opacity: this.opacity,\n      });\n      this.loaded = true;\n      this.render();\n    };\n  }\n\n  // 渲染\n  render(isFadeIn = false) {\n    if (!this.loaded || !this.shouldRender(this.cacheKey)) {\n      return;\n    }\n    // 添加到图层\n    this.layer.add(this.img);\n    // 设置显示位置\n    this.img.x(this.x).y(this.y);\n    // 需要渐现\n    if (isFadeIn && this.opacity !== 0) {\n      this.hide();\n    }\n    this.fadeIn();\n  }\n\n  // 渐现\n  fadeIn() {\n    if (this.opacity >= 1) {\n      return;\n    }\n    let base = this.opacity;\n    let anim = new Konva.Animation((frame) => {\n      let opacity = (frame.time / this.fadeInDuration) * 1 + base;\n      this.opacity = opacity;\n      this.img.opacity(opacity);\n      if (opacity >= 1) {\n        anim.stop();\n      }\n    }, this.layer);\n    anim.start();\n  }\n\n  // 隐藏\n  hide() {\n    this.opacity = 0;\n    this.img.opacity(0);\n  }\n\n  // 更新要添加到的图层\n  updateLayer(layer) {\n    this.layer = layer;\n    return this;\n  }\n\n  // 更新位置\n  updatePos(x, y) {\n    this.x = x;\n    this.y = y;\n    return this;\n  }\n}\n\nexport default {\n  name: \"App\",\n  data() {\n    return {\n      // 画布宽高\n      width: 0,\n      height: 0,\n      // 鼠标按下标志\n      isMousedown: false,\n      // 缓存瓦片实例\n      tileCache: {},\n      // 记录当前画布上需要的瓦片\n      currentTileCache: {},\n      // 初始中心经纬度\n      initCenter: [120.148732, 30.231006], // 雷锋塔\n      center: [120.148732, 30.231006], // 雷锋塔\n      // 初始缩放层级\n      zoom: 14,\n      // 缩放层级范围\n      minZoom: 3,\n      maxZoom: 18,\n      // 缩放相关\n      lastZoom: 0,\n      scale: 1,\n      scaleTmp: 1,\n      playback: null,\n      // 图层相关\n      stage: null,\n      layer1: null,\n      layer2: null,\n      useLayer1: true,\n      // 搜索&移动\n      searchText: \"\",\n      searchTimer: null,\n      searchResultList: [],\n      translate: [0, 0],\n      translateTmp: [0, 0],\n      translatePlayback: null,\n      // 经纬度框\n      posValue: \"\",\n    };\n  },\n  watch: {\n    center(val) {\n      this.posValue = val.join(\",\");\n    },\n  },\n  async mounted() {\n    await this.location();\n    this.init();\n    this.renderTiles();\n    window.addEventListener(\"mousemove\", this.onMousemove);\n    window.addEventListener(\"mouseup\", this.onMouseup);\n    window.addEventListener(\"wheel\", this.onMousewheel);\n  },\n  beforeUnmount() {\n    window.removeEventListener(\"mousemove\", this.onMousemove);\n    window.removeEventListener(\"mouseup\", this.onMouseup);\n    window.removeEventListener(\"wheel\", this.onMousewheel);\n  },\n  methods: {\n    // 定位\n    async location() {\n      try {\n        let response = await fetch(`https://restapi.amap.com/v3/ip?key=${KEY}`);\n        let res = await response.json();\n        let arr = res.rectangle.split(\";\");\n        let pos1 = arr[0].split(\",\");\n        let pos2 = arr[1].split(\",\");\n        this.initCenter = this.center = [\n          (Number(pos1[0]) + Number(pos2[0])) / 2,\n          (Number(pos1[1]) + Number(pos2[1])) / 2,\n        ];\n      } catch (error) {\n        console.log(error);\n      }\n    },\n\n    // 初始化\n    init() {\n      // 获取容器宽高\n      let { width, height } = this.$refs.mapBox.getBoundingClientRect();\n      this.width = width;\n      this.height = height;\n\n      // 创建舞台\n      this.stage = new Konva.Stage({\n        container: this.$refs.mapBox,\n        width,\n        height,\n      });\n\n      // 创建两个图层\n      this.layer1 = new Konva.Layer();\n      this.layer1.x(this.width / 2).y(this.height / 2);\n      this.stage.add(this.layer1);\n\n      this.layer2 = new Konva.Layer();\n      this.layer2.x(this.width / 2).y(this.height / 2);\n      this.stage.add(this.layer2);\n    },\n\n    // 计算显示范围内的瓦片行列号\n    renderTiles(isFadeIn = false) {\n      // 中心点对应的瓦片\n      let centerTile = getTileRowAndCol(\n        ...lngLat2Mercator(...this.center),\n        this.zoom\n      );\n      // 中心瓦片左上角对应的像素坐标\n      let centerTilePos = [\n        centerTile[0] * TILE_SIZE,\n        centerTile[1] * TILE_SIZE,\n      ];\n      // 中心点对应的像素坐标\n      let centerPos = getPxFromLngLat(...this.center, this.zoom);\n      // 中心像素坐标距中心瓦片左上角的差值\n      let offset = [\n        centerPos[0] - centerTilePos[0],\n        centerPos[1] - centerTilePos[1],\n      ];\n      // 计算瓦片数量\n      let rowMinNum = Math.ceil((this.width / 2 - offset[0]) / TILE_SIZE);\n      let colMinNum = Math.ceil((this.height / 2 - offset[1]) / TILE_SIZE);\n      let rowMaxNum = Math.ceil(\n        (this.width / 2 - (TILE_SIZE - offset[0])) / TILE_SIZE\n      );\n      let colMaxNum = Math.ceil(\n        (this.height / 2 - (TILE_SIZE - offset[1])) / TILE_SIZE\n      );\n      // 渲染画布内所有瓦片\n      this.currentTileCache = {}; // 清空缓存对象\n      for (let i = -rowMinNum; i <= rowMaxNum; i++) {\n        for (let j = -colMinNum; j <= colMaxNum; j++) {\n          // 当前瓦片的行列号\n          let row = centerTile[0] + i;\n          let col = centerTile[1] + j;\n          // 当前瓦片的显示位置\n          let x = i * TILE_SIZE - offset[0];\n          let y = j * TILE_SIZE - offset[1];\n          // 缓存key\n          let cacheKey = row + \"_\" + col + \"_\" + this.zoom;\n          // 记录当前需要的瓦片\n          this.currentTileCache[cacheKey] = true;\n          // 该瓦片已加载过\n          let layer = this.useLayer1 ? this.layer1 : this.layer2;\n          if (this.tileCache[cacheKey]) {\n            this.tileCache[cacheKey]\n              .updateLayer(layer)\n              .updatePos(x, y)\n              .render(isFadeIn);\n          } else {\n            // 未加载过\n            this.tileCache[cacheKey] = new Tile({\n              layer,\n              row,\n              col,\n              zoom: this.zoom,\n              x,\n              y,\n              // 判断瓦片是否在当前画布缓存对象上，是的话则代表需要渲染\n              shouldRender: (key) => {\n                return this.currentTileCache[key];\n              },\n            });\n          }\n        }\n      }\n    },\n\n    // 清空图层\n    clearLayer() {\n      this.layer1.removeChildren();\n      this.layer2.removeChildren();\n    },\n\n    // 重置图层\n    resetLayer() {\n      // 如果当前元素显示在图层1，那么即将切换为图层2，所以将图层二的缩放复位、清空旧的元素、置顶显示，反之亦然\n      let currentLayer = this.useLayer1 ? this.layer1 : this.layer2;\n      let willLayer = this.useLayer1 ? this.layer2 : this.layer1;\n      willLayer.scale({\n        x: 1,\n        y: 1,\n      });\n      willLayer.x(this.width / 2).y(this.height / 2);\n      willLayer.removeChildren();\n      currentLayer.zIndex(0);\n      willLayer.zIndex(1);\n    },\n\n    // 鼠标按下\n    onMousedown(e) {\n      if (e.which === 1) {\n        this.isMousedown = true;\n      }\n    },\n\n    // 鼠标移动\n    onMousemove(e) {\n      if (!this.isMousedown) {\n        return;\n      }\n      // 计算本次拖动的距离对应的经纬度数据\n      let mx = e.movementX * resolutions[this.zoom];\n      let my = e.movementY * resolutions[this.zoom];\n      let [x, y] = lngLat2Mercator(...this.center);\n      // 更新拖动后的中心点经纬度\n      this.center = mercatorToLngLat(x - mx, my + y);\n      // 清除画布重新渲染瓦片\n      this.clearLayer();\n      this.renderTiles();\n    },\n\n    // 鼠标松开\n    onMouseup() {\n      this.isMousedown = false;\n    },\n\n    // 鼠标滚动\n    onMousewheel(e) {\n      if (e.deltaY > 0) {\n        this.zoomOut();\n      } else {\n        this.zoomIn();\n      }\n    },\n\n    // 放大\n    zoomIn() {\n      this.scaleMap(true);\n    },\n\n    // 缩小\n    zoomOut() {\n      this.scaleMap(false);\n    },\n\n    // 缩放\n    scaleMap(zoomIn) {\n      if (!zoomIn) {\n        // 层级变小\n        if (this.zoom > this.minZoom) this.zoom--;\n      } else {\n        // 层级变大\n        if (this.zoom < this.maxZoom) this.zoom++;\n      }\n      // 层级未发生改变\n      if (this.lastZoom === this.zoom) {\n        return;\n      }\n      this.lastZoom = this.zoom;\n      // 更新缩放比例，也就是目标缩放值\n      this.scale *= !zoomIn > 0 ? 0.5 : 2;\n      // 停止上一次动画\n      if (this.playback) {\n        this.playback.stop();\n      }\n      // 图层重置\n      this.resetLayer();\n      // 开启动画\n      this.playback = animate({\n        from: this.scaleTmp, // 当前缩放值\n        to: this.scale, // 目标缩放值\n        onUpdate: (latest) => {\n          console.log(latest);\n          // 实时更新当前缩放值\n          this.scaleTmp = latest;\n          let layer = this.useLayer1 ? this.layer1 : this.layer2;\n          layer.scale({\n            x: latest,\n            y: latest,\n          });\n        },\n        onComplete: () => {\n          // 切换图层\n          this.useLayer1 = !this.useLayer1;\n          // 动画完成后将缩放值重置为1\n          this.scale = 1;\n          this.scaleTmp = 1;\n          // 根据最终缩放值重新计算需要的瓦片并渲染\n          this.renderTiles(true);\n        },\n      });\n    },\n\n    // 搜索\n    onSearch() {\n      clearTimeout(this.searchTimer);\n      this.searchTimer = setTimeout(() => {\n        if (this.searchText.trim()) {\n          fetch(\n            `https://restapi.amap.com/v3/assistant/inputtips?key=${KEY}&keywords=${this.searchText.trim()}`\n          )\n            .then((response) => {\n              return response.json();\n            })\n            .then((response) => {\n              this.searchResultList = response.tips || [];\n            });\n        } else {\n          this.searchResultList = [];\n        }\n      }, 300);\n    },\n\n    // 定位到指定位置\n    go(newCenter) {\n      if (this.translatePlayback) {\n        return;\n      }\n      if (typeof newCenter === \"string\") {\n        newCenter = newCenter.split(\",\").map((item) => {\n          return Number(item);\n        });\n      }\n      // 目标位置经纬度转3857坐标\n      let newCenterMercator = lngLat2Mercator(...newCenter);\n      // 当前经纬度转3857坐标\n      let centerMercator = lngLat2Mercator(...this.center);\n      // 计算两者的距离，转换成像素\n      this.translate = [\n        (newCenterMercator[0] - centerMercator[0]) / resolutions[this.zoom],\n        (newCenterMercator[1] - centerMercator[1]) / resolutions[this.zoom],\n      ];\n      // 重置画布\n      this.resetLayer();\n      // 开启动画\n      this.translatePlayback = animate({\n        from: this.translateTmp.join(\" \"),\n        to: this.translate.join(\" \"),\n        duration: 1000,\n        onUpdate: (latest) => {\n          this.translateTmp = latest.split(\" \").map((item) => {\n            return Number(item);\n          });\n          let layer = this.useLayer1 ? this.layer1 : this.layer2;\n          // 画布移动\n          layer\n            .x(this.width / 2 - this.translateTmp[0])\n            .y(this.translateTmp[1] + this.height / 2);\n        },\n        onComplete: () => {\n          this.translatePlayback = null;\n          // 中心点更新为目标经纬度\n          this.center = newCenter;\n          this.useLayer1 = !this.useLayer1;\n          this.translateTmp = [0, 0];\n          this.translate = [0, 0];\n          // 当前不在画布上的瓦片透明度都恢复成0\n          Object.keys(this.tileCache).forEach((cacheKey) => {\n            if (!this.currentTileCache[cacheKey]) {\n              this.tileCache[cacheKey].hide();\n            }\n          });\n          // 重新渲染瓦片\n          this.renderTiles();\n        },\n      });\n    },\n\n    // 回到初始位置\n    backCenter() {\n      this.go(this.initCenter);\n    },\n\n    // 切换经纬度\n    onChangePos() {\n      this.go(this.posValue);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.map {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n  background-color: rgb(244, 244, 244);\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAYAAADL1t+KAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTI0RTg4NzlGRDk5MTFFNjlDNTFBODNCMUQwNzgyQjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTI0RTg4N0FGRDk5MTFFNjlDNTFBODNCMUQwNzgyQjgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMjRFODg3N0ZEOTkxMUU2OUM1MUE4M0IxRDA3ODJCOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMjRFODg3OEZEOTkxMUU2OUM1MUE4M0IxRDA3ODJCOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmlSGaMAAAujSURBVHja7NyxbSNZEARQ7kKmEiDTYP4hKI1TAvK5nAzERt+gWHgPoNeOpowSvlF/Ho/H5Rduz99/7v73u/vz9+W7yMOdPOTh7tU8/l4AgLen0AFAoQMACh0AUOgAgEIHAIUOACh0AGDRn8fjcfMZYlyfv2+fQR7IQx68msfHxeJO0t3Vd5GHO3nIw90kD0/uAFBAoQOAQgcAFDoAoNABAIUOAAodAFDoAMAiS3FZLC/JA3nIg1EeluKy7iwvycOdPOThbpSHJ3cAKKDQAUChAwAKHQBQ6ACAQgcAhQ4AKHQAYJGluCyWl+SBPOTBKA9LcVl3lpfk4U4e8nA3ysOTOwAUUOgAoNABAIUOACh0AEChA4BCBwAUOgCwyFJcFstL8kAe8mCUh6W4rDvLS/JwJw95uBvl4ckdAAoodABQ6ACAQgcAFDoAoNABQKEDAAodAFjUshT3+fz9FPwdLctL8pCHPOQhj5PzsBSXdWd5SR7u5CEPd6M8PLkDQAGFDgAKHQBQ6ACAQgcAFDoAKHQAQKEDAItaluJatCwvyQN5yIOT87AUl3VneUke7uQhD3ejPDy5A0ABhQ4ACh0AUOgAgEIHABQ6ACh0AEChAwCLLMVlsbwkD+QhD0Z5WIrLurO8JA938pCHu1EentwBoIBCBwCFDgAodABAoQMACh0AFDoAoNABgEWW4rJYXpIH8pAHozwsxWXdWV6Shzt5yMPdKA9P7gBQQKEDgEIHABQ6AKDQAQCFDgAKHQBQ6ADAIktxWSwvyQN5yINRHpbisu4sL8nDnTzk4W6Uhyd3ACig0AFAoQMACh0AUOgAgEIHAIUOACh0AGDRsRR39xkA4P0L/Td3lnnOuTv+ufryXeThTh7ycPdqHp7cAaCAQgcAhQ4AKHQAQKEDAAodABQ6AKDQAYBFx7DMzWeIcX3+vn0GeSAPefBqHh8XiztJd1ffRR7u5CEPd5M8PLkDQAGFDgAKHQBQ6ACAQgcAFDoAKHQAQKEDAIssxWWxvCQP5CEPRnlYisu6s7wkD3fykIe7UR6e3AGggEIHAIUOACh0AEChAwAKHQAUOgCg0AGARZbislhekgfykAejPCzFZd1ZXpKHO3nIw90oD0/uAFBAoQOAQgcAFDoAoNABAIUOAAodAFDoAMAiS3FZLC/JA3nIg1EeluKy7iwvycOdPOThbpSHJ3cAKKDQAUChAwAKHQBQ6ACAQgcAhQ4AKHQAYFHLUtzn8/dT8He0LC/JQx7ykIc8Ts7DUlzWneUlebiThzzcjfLw5A4ABRQ6ACh0AEChAwAKHQBQ6ACg0AEAhQ4ALGpZimvRsrwkD+QhD07Ow1Jc1p3lJXm4k4c83I3y8OQOAAUUOgAodABAoQMACh0AUOgAoNABAIUOACyyFJfF8pI8kIc8GOVhKS7rzvKSPNzJQx7uRnl4cgeAAgodABQ6AKDQAQCFDgAodABQ6ACAQgcAFlmKy2J5SR7IQx6M8rAUl3VneUke7uQhD3ejPDy5A0ABhQ4ACh0AUOgAgEIHABQ6ACh0AEChAwCLLMVlsbwkD+QhD0Z5WIrLurO8JA938pCHu1EentwBoIBCBwCFDgAodABAoQMACh0AFDoAoNABgEXHUtzdZwCA9y/039xZ5jnn7vjn6st3kYc7ecjD3at5eHIHgAIKHQAUOgCg0AEAhQ4AKHQAUOgAgEIHABYdwzI3nyHG9fn79hnkgTzkwat5fFws7iTdXX0XebiThzzcTfLw5A4ABRQ6ACh0AEChAwAKHQBQ6ACg0AEAhQ4ALLIUl8XykjyQhzwY5WEpLuvO8pI83MlDHu5GeXhyB4ACCh0AFDoAoNABAIUOACh0AFDoAIBCBwAWWYrLYnlJHshDHozysBSXdWd5SR7u5CEPd6M8PLkDQAGFDgAKHQBQ6ACAQgcAFDoAKHQAQKEDAIssxWWxvCQP5CEPRnlYisu6s7wkD3fykIe7UR6e3AGggEIHAIUOACh0AEChAwAKHQAUOgCg0AGARS1LcZ/P30/B39GyvCQPechDHvI4OQ9LcVl3lpfk4U4e8nA3ysOTOwAUUOgAoNABAIUOACh0AEChA4BCBwAUOgCwqGUprkXL8pI8kIc8ODkPS3FZd5aX5OFOHvJwN8rDkzsAFFDoAKDQAQCFDgAodABAoQOAQgcAFDoAsMhSXBbLS/JAHvJglIeluKw7y0vycCcPebgb5eHJHQAKKHQAUOgAgEIHABQ6AKDQAUChAwAKHQBYZCkui+UleSAPeTDKw1Jc1p3lJXm4k4c83I3y8OQOAAUUOgAodABAoQMACh0AUOgAoNABAIUOACyyFJfF8pI8kIc8GOVhKS7rzvKSPNzJQx7uRnl4cgeAAgodABQ6AKDQAQCFDgAodABQ6ACAQgcAFh1LcXefAQDev9B/c2eZ55y745+rL99FHu7kIQ93r+bhyR0ACih0AFDoAIBCBwAUOgCg0AFAoQMACh0AWHQMy9x8hhjX5+/bZ5AH8pAHr+bxcbG4k3R39V3k4U4e8nA3ycOTOwAUUOgAoNABAIUOACh0AEChA4BCBwAUOgCwyFJcFstL8kAe8mCUh6W4rDvLS/JwJw95uBvl4ckdAAoodABQ6ACAQgcAFDoAoNABQKEDAAodAFhkKS6L5SV5IA95MMrDUlzWneUlebiThzzcjfLw5A4ABRQ6ACh0AEChAwAKHQBQ6ACg0AEAhQ4ALLIUl8XykjyQhzwY5WEpLuvO8pI83MlDHu5GeXhyB4ACCh0AFDoAoNABAIUOACh0AFDoAIBCBwAWtSzFfT5/PwV/R8vykjzkIQ95yOPkPCzFZd1ZXpKHO3nIw90oD0/uAFBAoQOAQgcAFDoAoNABAIUOAAodAFDoAMCilqW4Fi3LS/JAHvLg5DwsxWXdWV6Shzt5yMPdKA9P7gBQQKEDgEIHABQ6AKDQAQCFDgAKHQBQ6ADAIktxWSwvyQN5yINRHpbisu4sL8nDnTzk4W6Uhyd3ACig0AFAoQMACh0AUOgAgEIHAIUOACh0AGCRpbgslpfkgTzkwSgPS3FZd5aX5OFOHvJwN8rDkzsAFFDoAKDQAQCFDgAodABAoQOAQgcAFDoAsMhSXBbLS/JAHvJglIeluKw7y0vycCcPebgb5eHJHQAKKHQAUOgAgEIHABQ6AKDQAUChAwAKHQBYdCzF3X0GAHj/Qv/NnWWec+6Of66+fBd5uJOHPNy9mocndwAooNABQKEDAAodAFDoAIBCBwCFDgAodABg0TEsc/MZYlyfv2+fQR7IQx68msfHxeJO0t3Vd5GHO3nIw90kD0/uAFBAoQOAQgcAFDoAoNABAIUOAAodAFDoAMAiS3FZLC/JA3nIg1EeluKy7iwvycOdPOThbpSHJ3cAKKDQAUChAwAKHQBQ6ACAQgcAhQ4AKHQAYJGluCyWl+SBPOTBKA9LcVl3lpfk4U4e8nA3ysOTOwAUUOgAoNABAIUOACh0AEChA4BCBwAUOgCwyFJcFstL8kAe8mCUh6W4rDvLS/JwJw95uBvl4ckdAAoodABQ6ACAQgcAFDoAoNABQKEDAAodAFjUshT3+fz9FPwdLctL8pCHPOQhj5PzsBSXdWd5SR7u5CEPd6M8PLkDQAGFDgAKHQBQ6ACAQgcAFDoAKHQAQKEDAItaluJatCwvyQN5yIOT87AUl3VneUke7uQhD3ejPDy5A0ABhQ4ACh0AUOgAgEIHABQ6ACh0AEChAwCLLMVlsbwkD+QhD0Z5WIrLurO8JA938pCHu1EentwBoIBCBwCFDgAodABAoQMACh0AFDoAoNABgEWW4rJYXpIH8pAHozwsxWXdWV6Shzt5yMPdKA9P7gBQQKEDgEIHABQ6AKDQAQCFDgAKHQBQ6ADAIktxWSwvyQN5yINRHpbisu4sL8nDnTzk4W6Uhyd3ACig0AFAoQMACh0AUOgAgEIHAIUOACh0AGDRsRR39xkA4L39E2AAdhk/ILAOHTMAAAAASUVORK5CYII=);\n  background-repeat: repeat;\n}\n\n.map * {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n.mapBox {\n  width: 100%;\n  height: 100%;\n}\n\n.line {\n  position: absolute;\n  background-color: #000;\n}\n\n.lineX {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  width: 50px;\n  height: 2px;\n}\n\n.lineY {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  height: 50px;\n  width: 2px;\n}\n\n.center {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translateX(-50%);\n}\n\n.searchBox {\n  position: absolute;\n  left: 20px;\n  top: 20px;\n  width: 200px;\n}\n\n.searchInput {\n  width: 100%;\n  height: 30px;\n}\n\n.searchInput input,\n.posInput input {\n  width: 100%;\n  height: 100%;\n  padding: 0 10px;\n}\n\n.searchList {\n  position: absolute;\n  left: 0px;\n  top: 35px;\n  width: 100%;\n  background-color: #fff;\n}\n\n.searchList .searchItem {\n  width: 100%;\n  height: 30px;\n  line-height: 30px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: 0 10px;\n  cursor: pointer;\n}\n\n.searchList .searchItem:hover {\n  background-color: #f5f5f5;\n}\n\n.posInput {\n  position: absolute;\n  right: 20px;\n  top: 20px;\n  width: 300px;\n  height: 30px;\n}\n\n.backCenterBtn {\n  position: absolute;\n  right: 20px;\n  bottom: 20px;\n  width: 50px;\n  height: 50px;\n  background-image: url(\"./assets/location.png\");\n  background-size: cover;\n  cursor: pointer;\n}\n\n.scaleBtnBox {\n  position: absolute;\n  right: 30px;\n  bottom: 80px;\n  width: 29px;\n  height: 73px;\n  padding: 0 2px;\n  background: #fff;\n  border-radius: 3px;\n}\n\n.scaleBtn {\n  width: 24px;\n  height: 36px;\n  margin: 0 auto;\n  background: url(\"./assets/scale.png\") no-repeat;\n  cursor: pointer;\n}\n\n.scaleBtn.in {\n  background-position: -3px 3px;\n  border-bottom: 1px #dfdfdf solid;\n}\n\n.scaleBtn.out {\n  background-position: -3px -156px;\n}\n\n.scaleBtn.disabled {\n  opacity: 0.2;\n}\n</style>\n","import { render } from \"./New.vue?vue&type=template&id=55edc4c4&scoped=true\"\nimport script from \"./New.vue?vue&type=script&lang=js\"\nexport * from \"./New.vue?vue&type=script&lang=js\"\n\nimport \"./New.vue?vue&type=style&index=0&id=55edc4c4&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/linwang/Documents/lxqnsys/web_map_demo/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-55edc4c4\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=7fb52170&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=7fb52170&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/linwang/Documents/lxqnsys/web_map_demo/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7fb52170\"]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./New.vue?vue&type=style&index=0&id=55edc4c4&scoped=true&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./App.vue?vue&type=style&index=0&id=7fb52170&scoped=true&lang=css\""],"sourceRoot":""}