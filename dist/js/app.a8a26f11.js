(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==i[c]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},s=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="dist/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var h=c;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"1fd6":function(t,e,a){},5352:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("7a23"),i={class:"app"},s={class:"mapContainer"},o={class:"btnGroup"};function r(t,e,a,r,c,l){var h=this;return Object(n["h"])(),Object(n["d"])("div",i,[Object(n["e"])("div",s,[(Object(n["h"])(),Object(n["c"])(Object(n["l"])(c.comp)))]),Object(n["e"])("div",o,[Object(n["e"])("div",{class:Object(n["f"])(["btn",{active:"New"===this.comp}]),onClick:e[0]||(e[0]=function(t){return h.comp="New"})}," 优化版 ",2),Object(n["e"])("div",{class:Object(n["f"])(["btn",{active:"Old"===this.comp}]),onClick:e[1]||(e[1]=function(t){return h.comp="Old"})}," 原始版 ",2)])])}var c=function(t){return Object(n["j"])("data-v-7f5862c5"),t=t(),Object(n["i"])(),t},l={class:"map",ref:"map"},h={class:"center"},u=c((function(){return Object(n["e"])("div",{class:"line lineX"},null,-1)})),p=c((function(){return Object(n["e"])("div",{class:"line lineY"},null,-1)}));function d(t,e,a,i,s,o){return Object(n["h"])(),Object(n["d"])("div",l,[Object(n["e"])("canvas",{ref:"canvas",onMousedown:e[0]||(e[0]=function(){return o.onMousedown&&o.onMousedown.apply(o,arguments)})},null,544),Object(n["e"])("div",h,Object(n["m"])(this.center[0]+","+this.center[1]),1),u,p],512)}for(var m=a("3835"),f=a("2909"),v=a("d4ec"),y=a("bee2"),b=(a("d81d"),a("99af"),a("d3b7"),a("159b"),a("b64b"),a("3623")),g=(a("ac1f"),a("466d"),a("1276"),a("fb6a"),a("a9e3"),a("5319"),function(t){return t*(Math.PI/180)}),M=function(t){return t*(180/Math.PI)},w=6378137,O=function(t,e){var a=g(t)*w,n=g(e),i=Math.sin(n),s=w/2*Math.log((1+i)/(1-i));return[a,s]},j=function(t,e){var a=M(t)/w,n=M(2*Math.atan(Math.exp(e/w))-Math.PI/2);return[a,n]},T=2*Math.PI*w,x=256,A=function(t){var e=Math.pow(2,t),a=e*x;return T/a},z=[],C=0;C<=18;C++)z.push(A(C));var L=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"topLeft";return"topLeft"===a&&(t+=T/2,e=T/2-e),[t,e]},D=function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=L.apply(void 0,Object(f["a"])((n.lngLatToMercator||O)(t,e)).concat([n.origin])),s=Object(m["a"])(i,2),o=s[0],r=s[1],c=(n.resolutions||z)[a],l=Math.floor(o/c/x),h=Math.floor(r/c/x);return[l,h]},k=function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=L.apply(void 0,Object(f["a"])((n.lngLatToMercator||O)(t,e)).concat([n.origin])),s=Object(m["a"])(i,2),o=s[0],r=s[1],c=(n.resolutions||z)[a],l=Math.floor(o/c),h=Math.floor(r/c);return[l,h]},P=function(t,e,a){var n=[1,2,3,4],i=n[Math.floor(Math.random()*n.length)];return"https://webrd0".concat(i,".is.autonavi.com/appmaptile?x=").concat(t,"&y=").concat(e,"&z=").concat(a,"&lang=zh_cn&size=1&scale=1&style=8")},I=function(t){var e=t.match(/\{[\d-]+\}/);if(e){for(var a=e[0].slice(1,-1).split(/\s*-\s*/),n=[],i=Number(a[0]);i<=Number(a[1]);i++)n.push(i);return n[Math.floor(Math.random()*n.length)]}return null},S=function(t,e,a,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=i.transformXYZ,o=i.getTileUrl,r=I(n);if(""!==r&&(n=n.replace(/\{[\d-]+\}/,r)),o)return o(t,e,a);if(s){var c=s(t,e,a);t=c[0],e=c[1],a=c[2]}return n.replace("{x}",t).replace("{y}",e).replace("{z}",a)},B="0913a20b5d5a703b920e1ff0d9d26559",R=function(){function t(e){var a=e.ctx,n=e.row,i=e.col,s=e.zoom,o=e.x,r=e.y,c=e.shouldRender;Object(v["a"])(this,t),this.ctx=a,this.row=n,this.col=i,this.zoom=s,this.x=o,this.y=r,this.shouldRender=c,this.url="",this.cacheKey=this.row+"_"+this.col+"_"+this.zoom,this.img=null,this.loaded=!1,this.timer=null,this.createUrl(),this.load()}return Object(y["a"])(t,[{key:"createUrl",value:function(){this.url=P(this.row,this.col,this.zoom)}},{key:"load",value:function(){var t=this;this.img=new Image,this.img.src=this.url,this.timer=setTimeout((function(){t.createUrl(),t.load()}),1e3),this.img.onload=function(){clearTimeout(t.timer),t.loaded=!0,t.render()}}},{key:"render",value:function(){this.loaded&&this.shouldRender(this.cacheKey)&&this.ctx.drawImage(this.img,this.x,this.y)}},{key:"updatePos",value:function(t,e){return this.x=t,this.y=e,this}}]),t}(),U={name:"App",data:function(){return{width:0,height:0,isMousedown:!1,tileCache:{},currentTileCache:{},center:[120.148732,30.231006],zoom:17,minZoom:3,maxZoom:18,ctx:null,lastZoom:0,scale:1,scaleTmp:1,playback:null}},mounted:function(){this.initCanvas(),this.renderTiles(),window.addEventListener("mousemove",this.onMousemove),window.addEventListener("mouseup",this.onMouseup),window.addEventListener("wheel",this.onMousewheel)},beforeUnmount:function(){window.removeEventListener("mousemove",this.onMousemove),window.removeEventListener("mouseup",this.onMouseup),window.removeEventListener("wheel",this.onMousewheel)},methods:{initCanvas:function(){var t=this.$refs.map.getBoundingClientRect(),e=t.width,a=t.height;this.width=e,this.height=a;var n=this.$refs.canvas;n.width=this.width,n.height=this.height,this.ctx=n.getContext("2d"),this.ctx.translate(this.width/2,this.height/2)},renderTiles:function(){var t=this,e=D.apply(void 0,Object(f["a"])(O.apply(void 0,Object(f["a"])(this.center))).concat([this.zoom])),a=[e[0]*x,e[1]*x],n=k.apply(void 0,Object(f["a"])(this.center).concat([this.zoom])),i=[n[0]-a[0],n[1]-a[1]],s=Math.ceil((this.width/2-i[0])/x),o=Math.ceil((this.height/2-i[1])/x),r=Math.ceil((this.width/2-(x-i[0]))/x),c=Math.ceil((this.height/2-(x-i[1]))/x);this.currentTileCache={};for(var l=-s;l<=r;l++)for(var h=-o;h<=c;h++){var u=e[0]+l,p=e[1]+h,d=l*x-i[0],m=h*x-i[1],v=u+"_"+p+"_"+this.zoom;this.currentTileCache[v]=!0,this.tileCache[v]?this.tileCache[v].updatePos(d,m).render():this.tileCache[v]=new R({ctx:this.ctx,row:u,col:p,zoom:this.zoom,x:d,y:m,shouldRender:function(e){return t.currentTileCache[e]}})}},clear:function(){this.ctx.clearRect(-this.width/2,-this.height/2,this.width,this.height)},onMousedown:function(t){1===t.which&&(this.isMousedown=!0)},onMousemove:function(t){if(this.isMousedown){var e=t.movementX*z[this.zoom],a=t.movementY*z[this.zoom],n=O.apply(void 0,Object(f["a"])(this.center)),i=Object(m["a"])(n,2),s=i[0],o=i[1];this.center=j(s-e,a+o),this.clear(),this.renderTiles()}},onMouseup:function(){this.isMousedown=!1},onMousewheel:function(t){var e=this;t.deltaY>0?this.zoom>this.minZoom&&this.zoom--:this.zoom<this.maxZoom&&this.zoom++,this.lastZoom!==this.zoom&&(this.lastZoom=this.zoom,this.scale*=t.deltaY>0?.5:2,this.playback&&this.playback.stop(),this.playback=Object(b["a"])({from:this.scaleTmp,to:this.scale,onUpdate:function(t){e.scaleTmp=t,e.ctx.save(),e.clear(),e.ctx.scale(t,t),Object.keys(e.currentTileCache).forEach((function(t){e.tileCache[t].render()})),e.ctx.restore()},onComplete:function(){e.scale=1,e.scaleTmp=1,e.renderTiles()}}))}}},E=(a("9fc3"),a("6b0d")),K=a.n(E);const Z=K()(U,[["render",d],["__scopeId","data-v-7f5862c5"]]);var V=Z,X=(a("b0c0"),a("c0b1")),Y=a.n(X),F=function(t){return Object(n["j"])("data-v-01981d5b"),t=t(),Object(n["i"])(),t},Q={class:"map",ref:"map"},H=F((function(){return Object(n["e"])("div",{class:"line lineX"},null,-1)})),G=F((function(){return Object(n["e"])("div",{class:"line lineY"},null,-1)})),J={class:"searchBox"},W={class:"searchInput"},q={class:"searchList"},N=["onClick"],_={class:"mapTypeSelectBox"},$=["value"],tt={class:"posInput"},et={class:"scaleBtnBox"};function at(t,e,a,i,s,o){return Object(n["h"])(),Object(n["d"])("div",Q,[Object(n["e"])("div",{class:"mapBox",ref:"mapBox",onMousedown:e[0]||(e[0]=function(){return o.onMousedown&&o.onMousedown.apply(o,arguments)})},null,544),H,G,Object(n["e"])("div",J,[Object(n["e"])("div",W,[Object(n["p"])(Object(n["e"])("input",{type:"text",placeholder:"搜索...","onUpdate:modelValue":e[1]||(e[1]=function(t){return s.searchText=t}),onInput:e[2]||(e[2]=function(){return o.onSearch&&o.onSearch.apply(o,arguments)}),onKeyup:e[3]||(e[3]=Object(n["q"])((function(){return o.onSearch&&o.onSearch.apply(o,arguments)}),["enter"])),onClick:e[4]||(e[4]=Object(n["r"])((function(){}),["stop"]))},null,544),[[n["o"],s.searchText]])]),Object(n["e"])("div",q,[(Object(n["h"])(!0),Object(n["d"])(n["a"],null,Object(n["k"])(s.searchResultList,(function(t,e){return Object(n["h"])(),Object(n["d"])("div",{class:"searchItem",key:e,onClick:function(e){return o.go(t.location)}},Object(n["m"])(t.name),9,N)})),128))])]),Object(n["e"])("div",_,[Object(n["p"])(Object(n["e"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(t){return s.selectMapType=t}),onChange:e[6]||(e[6]=function(){return o.onSelectMapTypeChange&&o.onSelectMapTypeChange.apply(o,arguments)})},[(Object(n["h"])(!0),Object(n["d"])(n["a"],null,Object(n["k"])(s.mapList,(function(t){return Object(n["h"])(),Object(n["d"])("option",{key:t.value,value:t.value},Object(n["m"])(t.name),9,$)})),128))],544),[[n["n"],s.selectMapType]])]),Object(n["e"])("div",tt,[Object(n["p"])(Object(n["e"])("input",{type:"text",placeholder:"经纬度...","onUpdate:modelValue":e[7]||(e[7]=function(t){return s.posValue=t}),onKeyup:e[8]||(e[8]=Object(n["q"])((function(){return o.onChangePos&&o.onChangePos.apply(o,arguments)}),["enter"])),onClick:e[9]||(e[9]=Object(n["r"])((function(){}),["stop"]))},null,544),[[n["o"],s.posValue]])]),Object(n["e"])("div",{class:"backCenterBtn",onClick:e[10]||(e[10]=Object(n["r"])((function(){return o.backCenter&&o.backCenter.apply(o,arguments)}),["stop"]))}),Object(n["e"])("div",et,[Object(n["e"])("div",{class:Object(n["f"])(["scaleBtn in",{disabled:s.zoom>=s.maxZoom}]),onClick:e[11]||(e[11]=Object(n["r"])((function(){return o.zoomIn&&o.zoomIn.apply(o,arguments)}),["stop"]))},null,2),Object(n["e"])("div",{class:Object(n["f"])(["scaleBtn out",{disabled:s.zoom<=s.minZoom}]),onClick:e[12]||(e[12]=Object(n["r"])((function(){return o.zoomOut&&o.zoomOut.apply(o,arguments)}),["stop"]))},null,2)]),Object(n["e"])("img",{class:"overlay",src:Y.a,style:Object(n["g"])({left:s.overlayPos.x+"px",top:s.overlayPos.y+"px"}),alt:""},null,4)],512)}var nt=a("1da1"),it=(a("96cf"),a("3ca3"),a("ddb0"),a("25f0"),a("a15b"),a("7db0"),a("498a"),a("f1ac")),st=a("362d"),ot=a("a6d4"),rt=function(){function t(e,a){Object(v["a"])(this,t),this.timer=null,this.url=e,this.onload=a,this.called=!1,this.reloadTimes=0,this.load()}return Object(y["a"])(t,[{key:"load",value:function(){var t=this;if(this.reloadTimes>=5)this.called||(this.onload(null),this.called=!0);else{this.reloadTimes++;var e=new Image;e.src=this.url,this.timer=setTimeout((function(){t.load()}),1e3),e.onload=function(){clearTimeout(t.timer),t.called||(t.onload(e),t.called=!0)},e.onerror=function(){t.load()}}}}]),t}(),ct=function(){function t(e){var a=e.layer,n=e.row,i=e.col,s=e.zoom,o=e.x,r=e.y,c=e.shouldRender,l=e.getMapTypeData;Object(v["a"])(this,t),this.layer=a,this.row=n,this.col=i,this.zoom=s,this.x=o,this.y=r,this.shouldRender=c,this.getMapTypeData=l,this.urls=[],this.cacheKey=this.row+"_"+this.col+"_"+this.zoom,this.imgs=[],this.opacity=0,this.loaded=!1,this.timer=null,this.fadeInDuration=400,this.createUrl(),this.load()}return Object(y["a"])(t,[{key:"createUrl",value:function(){var t=this,e=this.getMapTypeData();this.urls=e.urls.map((function(a){return S(t.row,t.col,t.zoom,a,{getTileUrl:e.getTileUrl,transformXYZ:e.transformXYZ})}))}},{key:"load",value:function(){var t=this,e=this.urls.map((function(e,a){return new Promise((function(n){new rt(e,(function(e){e&&(t.imgs[a]=new st["a"].Image({image:e,width:x,height:x,opacity:t.opacity})),n()}))}))}));Promise.all(e).then((function(){t.loaded=!0,t.render()}))}},{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!this.loaded||this.imgs.length<=0||!this.shouldRender(this.cacheKey)||(this.imgs.forEach((function(e){e&&(t.layer.add(e),e.x(t.x).y(t.y))})),e&&0!==this.opacity&&this.hide(),this.fadeIn())}},{key:"fadeIn",value:function(){var t=this;if(!(this.opacity>=1||this.imgs.length<=0)){var e=this.opacity,a=new st["a"].Animation((function(n){var i=n.time/t.fadeInDuration*1+e;t.opacity=i,t.imgs.forEach((function(t){t&&t.opacity(i)})),i>=1&&a.stop()}),this.layer);a.start()}}},{key:"hide",value:function(){this.imgs.length<=0||(this.opacity=0,this.imgs.forEach((function(t){t&&t.opacity(0)})))}},{key:"updateLayer",value:function(t){return this.layer=t,this}},{key:"updatePos",value:function(t,e){return this.x=t,this.y=e,this}}]),t}(),lt={name:"App",data:function(){return{width:0,height:0,isMousedown:!1,lastMouseTime:null,lastDuration:0,lastDistance:[],tileCache:{},currentTileCache:{},initCenter:[120.148732,30.231006],center:[120.148732,30.231006],zoom:14,minZoom:3,maxZoom:18,lastZoom:0,scale:1,scaleTmp:1,playback:null,stage:null,layer1:null,layer2:null,useLayer1:!0,searchText:"",searchTimer:null,searchResultList:[],translate:[0,0],translateTmp:[0,0],translatePlayback:null,posValue:"",selectMapType:"",selectMapData:null,mapList:[{name:"高德地图",value:"gaode",urls:["https://webrd0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scale=1&style=8"]},{name:"高德影像图",value:"gaodeImage",urls:["https://webst0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&style=6","https://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=8&x={x}&y={y}&z={z}&scl=1&ltype=4"]},{name:"百度地图",value:"baidu",urls:["https://maponline2.bdimg.com/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=pl&scaler=2&udt=&from=jsapi2_0"],origin:"center",axis:["right","top"],resolutions:function(){for(var t=[],e=0;e<=18;e++)t[e]=Math.pow(2,18-e);return t}(),lngLatToMercator:function(t,e){return ot["a"].transform([t,e],ot["a"].GCJ02,ot["a"].BD09MC)},mercatorToLngLat:function(t,e){return ot["a"].transform([t,e],ot["a"].BD09MC,ot["a"].GCJ02)}},{name:"腾讯地图",value:"tx",urls:["https://rt{1-3}.map.gtimg.com/tile?z={z}&x={x}&y={y}&styleid=1&scene=0"],transformXYZ:function(t,e,a){return e=Math.pow(2,a)-e-1,[t,e,a]}},{name:"GeoQ",value:"geoq",urls:["http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}"]},{name:"天地图",value:"tianditu",urls:["http://t{0-7}.tianditu.com/DataServer?T=vec_w&tk=2c009e76130364aaf09aa30ef0621154&x={x}&y={y}&l={z}","http://t3.tianditu.com/DataServer?T=cva_w&tk=2c009e76130364aaf09aa30ef0621154&x={x}&y={y}&l={z}"],transformLngLat:function(t,e){return ot["a"].transform([t,e],ot["a"].GCJ02,ot["a"].WGS84)}},{name:"必应中文",value:"bing",urls:[""],getTileUrl:function(t,e,a){for(var n="",i=0;i<a;i++)n=((1&t)+2*(1&e)).toString()+n,t>>=1,e>>=1;var s=I("http://dynamic.t{0-3}.tiles.ditu.live.com/comp/ch/");return"http://dynamic.t".concat(s,".tiles.ditu.live.com/comp/ch/").concat(n,"?it=G,VE,BX,L,LA&mkt=zh-cn,syr&n=z&og=111&ur=CN")}}],overlayPos:{x:0,y:0},startOverlayPos:{x:0,y:0},overlayCood:[120.1829784447035,30.243167147657232]}},watch:{center:function(t){this.posValue=t.join(",")}},created:function(){this.selectMapType=this.mapList[0].value,this.changeMapType()},mounted:function(){var t=this;return Object(nt["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.init(),t.renderTiles(),window.addEventListener("mousemove",t.onMousemove),window.addEventListener("mouseup",t.onMouseup),window.addEventListener("wheel",t.onMousewheel);case 5:case"end":return e.stop()}}),e)})))()},beforeUnmount:function(){window.removeEventListener("mousemove",this.onMousemove),window.removeEventListener("mouseup",this.onMouseup),window.removeEventListener("wheel",this.onMousewheel)},methods:{onSelectMapTypeChange:function(){this.changeMapType(),this.tileCache={},this.currentTileCache={},this.clearLayer(),this.renderTiles()},changeMapType:function(){var t=this;this.selectMapData=this.mapList.find((function(e){return e.value===t.selectMapType}))},init:function(){var t=this.$refs.mapBox.getBoundingClientRect(),e=t.width,a=t.height;this.width=e,this.height=a,this.stage=new st["a"].Stage({container:this.$refs.mapBox,width:e,height:a}),this.layer1=new st["a"].Layer,this.layer1.x(this.width/2).y(this.height/2),this.stage.add(this.layer1),this.layer2=new st["a"].Layer,this.layer2.x(this.width/2).y(this.height/2),this.stage.add(this.layer2)},renderTiles:function(){var t,e=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.center;this.selectMapData.transformLngLat&&(n=(t=this.selectMapData).transformLngLat.apply(t,Object(f["a"])(this.center)));var i={origin:this.selectMapData.origin,resolutions:this.selectMapData.resolutions,lngLatToMercator:this.selectMapData.lngLatToMercator},s=D.apply(void 0,Object(f["a"])(n).concat([this.zoom,i])),o=[s[0]*x,s[1]*x],r=k.apply(void 0,Object(f["a"])(n).concat([this.zoom,i])),c=[r[0]-o[0],r[1]-o[1]],l=Math.ceil((this.width/2-c[0])/x),h=Math.ceil((this.height/2-c[1])/x),u=Math.ceil((this.width/2-(x-c[0]))/x),p=Math.ceil((this.height/2-(x-c[1]))/x),d=!!this.selectMapData.axis&&"top"===this.selectMapData.axis[1];this.currentTileCache={};for(var m=-l;m<=u;m++)for(var v=-h;v<=p;v++){var y=s[0]+m,b=s[1]+v,g=v;d&&0!==v&&(g=-v);var M=m*x-c[0],w=g*x-(d?x-c[1]:c[1]),O=y+"_"+b+"_"+this.zoom;this.currentTileCache[O]=!0;var j=this.getCurrentMainLayer();this.tileCache[O]?this.tileCache[O].updateLayer(j).updatePos(M,w).render(a):this.tileCache[O]=new ct({layer:j,row:y,col:b,zoom:this.zoom,x:M,y:w,shouldRender:function(t){return e.currentTileCache[t]},getMapTypeData:function(){return e.selectMapData}})}this.renderOverlay()},renderOverlay:function(){var t=(this.selectMapData.lngLatToMercator||O).apply(void 0,Object(f["a"])(this.center)),e=(this.selectMapData.lngLatToMercator||O).apply(void 0,Object(f["a"])(this.overlayCood)),a=[(e[0]-t[0])/(this.selectMapData.resolutions||z)[this.zoom],(e[1]-t[1])/(this.selectMapData.resolutions||z)[this.zoom]];this.overlayPos.x=a[0]+this.width/2,this.overlayPos.y=this.height/2-a[1]},clearLayer:function(){this.layer1.removeChildren(),this.layer2.removeChildren()},resetLayer:function(){var t=this.getCurrentMainLayer(),e=this.useLayer1?this.layer2:this.layer1;e.scale({x:1,y:1}),e.x(this.width/2).y(this.height/2),e.removeChildren(),t.zIndex(0),e.zIndex(1),this.startOverlayPos={x:this.overlayPos.x,y:this.overlayPos.y}},onMousedown:function(t){1===t.which&&(this.isMousedown=!0)},onMousemove:function(t){if(this.isMousedown){var e=Date.now();this.lastMouseTime&&(this.lastDuration=e-this.lastMouseTime,this.lastDistance=[t.movementX,t.movementY]),this.lastMouseTime=e;var a=t.movementX*(this.selectMapData.resolutions||z)[this.zoom],n=t.movementY*(this.selectMapData.resolutions||z)[this.zoom],i=(this.selectMapData.lngLatToMercator||O).apply(void 0,Object(f["a"])(this.center)),s=Object(m["a"])(i,2),o=s[0],r=s[1];this.center=(this.selectMapData.mercatorToLngLat||j)(o-a,n+r),this.clearLayer(),this.renderTiles()}},onMouseup:function(){this.isMousedown=!1,this.momentum()},momentum:function(){var t=this;if(this.lastDuration<=0)this.resetTranslate();else{var e=this.lastDistance[0]/this.lastDuration,a=this.lastDistance[1]/this.lastDuration;Math.abs(e)<=.3&&Math.abs(a)<=.3?this.resetTranslate():(this.translate=[this.translateTmp[0]+e/.005,this.translateTmp[1]+a/.005],this.resetLayer(),this.translatePlayback&&this.translatePlayback.stop(),this.translatePlayback=Object(b["a"])({from:this.translateTmp.join(" "),to:this.translate.join(" "),ease:it["b"],duration:300+(Math.abs(e)+Math.abs(a))/2*100,onUpdate:function(e){t.translateTmp=t.stringValueToArray(e);var a=t.getCurrentMainLayer();a.x(t.width/2+t.translateTmp[0]).y(t.height/2+t.translateTmp[1]),t.overlayPos.x=t.startOverlayPos.x+t.translateTmp[0],t.overlayPos.y=t.startOverlayPos.y+t.translateTmp[1]},onComplete:function(){var e=t.translate[0]*(t.selectMapData.resolutions||z)[t.zoom],a=t.translate[1]*(t.selectMapData.resolutions||z)[t.zoom],n=(t.selectMapData.lngLatToMercator||O).apply(void 0,Object(f["a"])(t.center)),i=Object(m["a"])(n,2),s=i[0],o=i[1];t.center=(t.selectMapData.mercatorToLngLat||j)(s-e,a+o),t.useLayer1=!t.useLayer1,t.resetTranslate(),t.hideTiles(),t.renderTiles()}}))}},onMousewheel:function(t){t.deltaY>0?this.zoomOut():this.zoomIn()},zoomIn:function(){this.scaleMap(!0)},zoomOut:function(){this.scaleMap(!1)},scaleMap:function(t){var e=this;t?this.zoom<this.maxZoom&&this.zoom++:this.zoom>this.minZoom&&this.zoom--,this.lastZoom!==this.zoom&&(this.lastZoom=this.zoom,this.scale*=!t>0?.5:2,this.playback&&this.playback.stop(),this.resetLayer(),this.playback=Object(b["a"])({from:this.scaleTmp,to:this.scale,duration:500,onUpdate:function(t){e.scaleTmp=t;var a=e.getCurrentMainLayer();a.scale({x:t,y:t});var n=(e.startOverlayPos.x-e.width/2)*t,i=(e.startOverlayPos.y-e.height/2)*t;e.overlayPos.x=n+e.width/2,e.overlayPos.y=i+e.height/2},onComplete:function(){e.useLayer1=!e.useLayer1,e.scale=1,e.scaleTmp=1,e.renderTiles(!0)}}))},onSearch:function(){var t=this;clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){t.searchText.trim()?fetch("https://restapi.amap.com/v3/assistant/inputtips?key=".concat(B,"&keywords=").concat(t.searchText.trim())).then((function(t){return t.json()})).then((function(e){t.searchResultList=e.tips||[]})):t.searchResultList=[]}),300)},go:function(t){var e=this;if(!this.translatePlayback){"string"===typeof t&&(t=t.split(",").map((function(t){return Number(t)})));var a=(this.selectMapData.lngLatToMercator||O).apply(void 0,Object(f["a"])(t)),n=(this.selectMapData.lngLatToMercator||O).apply(void 0,Object(f["a"])(this.center));this.translate=[(a[0]-n[0])/(this.selectMapData.resolutions||z)[this.zoom],(a[1]-n[1])/(this.selectMapData.resolutions||z)[this.zoom]],this.resetLayer(),this.translatePlayback=Object(b["a"])({from:this.translateTmp.join(" "),to:this.translate.join(" "),duration:1e3,onUpdate:function(t){e.translateTmp=e.stringValueToArray(t);var a=e.getCurrentMainLayer();a.x(e.width/2-e.translateTmp[0]).y(e.height/2+e.translateTmp[1]),e.overlayPos.x=e.startOverlayPos.x-e.translateTmp[0],e.overlayPos.y=e.startOverlayPos.y+e.translateTmp[1]},onComplete:function(){e.center=t,e.useLayer1=!e.useLayer1,e.resetTranslate(),e.hideTiles(),e.renderTiles()}})}},resetTranslate:function(){this.translatePlayback=null,this.translateTmp=[0,0],this.translate=[0,0],this.lastMouseTime=null,this.lastDuration=0,this.lastDistance=[]},hideTiles:function(){var t=this;Object.keys(this.tileCache).forEach((function(e){t.currentTileCache[e]||t.tileCache[e].hide()}))},stringValueToArray:function(t){return t.split(" ").map((function(t){return Number(t)}))},getCurrentMainLayer:function(){return this.useLayer1?this.layer1:this.layer2},backCenter:function(){this.go(this.initCenter)},onChangePos:function(){this.go(this.posValue)}}};a("f9ce");const ht=K()(lt,[["render",at],["__scopeId","data-v-01981d5b"]]);var ut=ht,pt={components:{New:ut,Old:V},data:function(){return{comp:"New"}}};a("c64c");const dt=K()(pt,[["render",r],["__scopeId","data-v-7fb52170"]]);var mt=dt;Object(n["b"])(mt).mount("#app")},"9fc3":function(t,e,a){"use strict";a("5352")},c0b1:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAHgAAAADKQTcFAAAE0klEQVRIDbVXa0ybVRg+/XpjFAqVjUGalkI6cBmORW5OgzK5zSxBQ8xCRiLzEn/oiFlYjAlZvJJsZj+8ZGg2cQuZmwvOIeMmLGTiBVGkBkcGjnVFzJhcNihU6Ffa+j4fnKW4WsuAJ3nznfOd93uf856e856nMuYfAr2Wk4WQaTUazX0VbxzZsS0jpyg6OjpJE6rWRoar1Ph0clp0zjjmpkdHRwd6OlvrDr3zWrvD4RinITvZHJmbzEP2vwDhOrKYxMTE9Nqm7lrbXy5xfMrjDcbge/ZC15dms/khxFiMhZhLIFvSW8gylN5Ff3Si/oW8/IL9kWFKKbOR2x728+8e1mvzsHG7l92e9kqf6sJlbL1WxraaBJaeKLBYHRaL0bgotjQ1fFD24tPHqTtC9jcZspfgS4xZaVQqlf6LZsv7D6dtzoOH9aaHfXZpnl0eCmq1WHKcwEqyFSwhZmECl763dOx5anuZKIo2Cucgk8g5MUhDQdrWOXR+i3nj/R5K6ORFF/u6584kySV4FDwoZ3tzlUwghl+vDFufyDIXuVwuK0WQMgchpobljDnf2ns0NdmU6XB62eFaF+vsDy5L+vYuXBvxsv5hD0uj5TfGROhSMgtSzp355BtynCbzgFhBpqPf9KWdOY+UIlOQ9v1x76QUT8LYlJcN3vCyrGQ5M5v0hoj1RmV7a/0vNOhAtiG0ew3YSPDG8q4GKWIBiIWYwO7ikr16vf4BampArK187/Sr2L3YSPf6myLwfwExEVsXrlK9fri6nPw2CCgO6akpT+Ij7N61Ao+dn/t4llqtTlSgIoWFyJU3bnkCHpnKZ1QsMwlbIjh0DbhZRY14xxnHEbUgVqdQlD7/cr6AMojR7quBN9NySBHPnz8KELCjYHe2ArUXHVQkjn9nl1sxy4dW9ARHYSZjcaZ4g4CCj2gogxz+ZsvHVvLkHJHasHUKfsvw2usb2DdT37avD29frMS9EhicI1KrVqF4LIAXT96nJw8GUt72GV5+c5HDS4sr4D5FBF2YH+blhw74BeeYmnaKAi5xeONq48BRWAtwjkn7zKwCyiFeH7ER9+lvizvb9/yt5gTAAdiuXxsWIFfQSdu08BJtf1juKvzYf/eqQSgAbY1nOmVUMrf2WSe7Ub3e/lwMWL38TSjYdxAIB4tVbGZ2fn6TQbNPIGE20fVTTwMCQDmsFXjspuaWLhIEY8jdXrG/5F1oJMgVKIfVxs5UuSSFbtmdroMHnj1L8a0gnhscHLQ1N174EISQK1uMgX9v+AULxCrNUUru1ceOfjUxMTFEHRtPb765oXYw49HClHhjbBzkCpQDFMRKANLyIiVTK2SssbXDcmDfnhqK10M2xg8vJgCxZ2rquFq3bbMhYTXFXnevdXhXdtKbbrfbQjxXyOY4MbWlfw4apVKZUHPu26q8xzK24+VK5S0yfa44p4pI+yhcLxlUpteXmPoSOQS9ofJI9SvQSJArGIBQwJ0drKDHRvr0eFXdobfKcWIukw2QSaT09AssO64aIwmzXcdOtbTbboquYP6+wAe+VSfqv4uKiiqjGIVk5sV4S5Jc0iEHDmxrTEBDtgEaCXIFygGXOO5TXG1wnrQ7RdRe23Xrn22Np384dfJjC84pDVnJbGT49wAxt2Sn/gPvDUS1Og7cLAAAAABJRU5ErkJggg=="},c64c:function(t,e,a){"use strict";a("e472")},e472:function(t,e,a){},f9ce:function(t,e,a){"use strict";a("1fd6")}});
//# sourceMappingURL=app.a8a26f11.js.map