{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/Old.vue","webpack:///./src/utils.js","webpack:///./src/Old.vue?68a3","webpack:///./src/New.vue","webpack:///./src/New.vue?648e","webpack:///./src/App.vue?6697","webpack:///./src/main.js","webpack:///./src/Old.vue?fe9a","webpack:///./src/assets/camera.png","webpack:///./src/App.vue?ab82","webpack:///./src/New.vue?3939"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","comp","ref","onMousedown","center","angleToRad","angle","Math","PI","radToAngle","rad","EARTH_RAD","lngLatToMercator","lng","lat","x","sin","y","log","mercatorToLngLat","atan","exp","EARTH_PERIMETER","TILE_SIZE","getResolution","tileNums","pow","tileTotalPx","resolutions","transformXY","origin","getTileRowAndCol","z","opt","resolution","row","floor","col","getPxFromLngLat","_x","_y","getTileUrl","domainIndexList","domainIndex","random","getRandomDomainIndex","url","res","match","arr","split","Number","getTileUrlPro","transformXYZ","replace","KEY","ctx","zoom","shouldRender","this","cacheKey","img","loaded","timer","createUrl","load","Image","src","setTimeout","onload","clearTimeout","render","drawImage","width","height","isMousedown","tileCache","currentTileCache","minZoom","maxZoom","lastZoom","scale","scaleTmp","playback","mounted","initCanvas","renderTiles","addEventListener","onMousemove","onMouseup","onMousewheel","beforeUnmount","removeEventListener","methods","$refs","map","getBoundingClientRect","canvas","getContext","translate","centerTile","centerTilePos","centerPos","offset","rowMinNum","ceil","colMinNum","rowMaxNum","colMaxNum","updatePos","clear","clearRect","e","which","mx","movementX","my","movementY","deltaY","stop","from","to","onUpdate","latest","save","keys","forEach","tile","restore","onComplete","__exports__","type","placeholder","searchText","onSearch","searchResultList","item","index","go","location","selectMapType","onSelectMapTypeChange","mapList","posValue","onChangePos","backCenter","zoomIn","zoomOut","style","overlayPos","alt","called","reloadTimes","onerror","layer","getMapTypeData","urls","imgs","opacity","fadeInDuration","mapData","tasks","Promise","resolve","image","all","then","isFadeIn","add","hide","fadeIn","base","anim","Animation","frame","time","start","lastMouseTime","lastDuration","lastDistance","initCenter","stage","layer1","layer2","useLayer1","searchTimer","translateTmp","translatePlayback","selectMapData","axis","transform","GCJ02","BD09MC","transformLngLat","WGS84","zIndex","toString","startOverlayPos","overlayCood","watch","val","join","created","changeMapType","init","clearLayer","find","mapBox","Stage","container","Layer","plusOpt","axisYIsTop","_j","getCurrentMainLayer","updateLayer","renderOverlay","removeChildren","resetLayer","currentLayer","willLayer","curTime","Date","now","momentum","resetTranslate","speedX","speedY","abs","ease","duration","stringValueToArray","hideTiles","scaleMap","trim","fetch","response","json","tips","newCenter","newCenterMercator","centerMercator","components","New","Old","createApp","App","mount"],"mappings":"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","file":"js/app.a8a26f11.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\r\n  <div class=\"app\">\r\n    <div class=\"mapContainer\">\r\n      <component :is=\"comp\"></component>\r\n    </div>\r\n    <div class=\"btnGroup\">\r\n      <div\r\n        class=\"btn\"\r\n        :class=\"{ active: this.comp === 'New' }\"\r\n        @click=\"this.comp = 'New'\"\r\n      >\r\n        优化版\r\n      </div>\r\n      <div\r\n        class=\"btn\"\r\n        :class=\"{ active: this.comp === 'Old' }\"\r\n        @click=\"this.comp = 'Old'\"\r\n      >\r\n        原始版\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Old from \"./Old\";\r\nimport New from \"./New\";\r\n\r\nexport default {\r\n  components: {\r\n    New,\r\n    Old,\r\n  },\r\n  data() {\r\n    return {\r\n      comp: \"New\",\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.btnGroup {\r\n  position: fixed;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  bottom: 50px;\r\n  display: flex;\r\n  height: 30px;\r\n  background-color: #fff;\r\n  border: 1px solid #b3b3b3;\r\n  border-radius: 5px;\r\n  overflow: hidden;\r\n  line-height: 30px;\r\n  cursor: pointer;\r\n}\r\n\r\n.btn {\r\n  padding: 0 16px;\r\n}\r\n\r\n.btn.active {\r\n  background-color: #e0e0e0;\r\n}\r\n</style>","<template>\r\n  <div class=\"map\" ref=\"map\">\r\n    <canvas ref=\"canvas\" @mousedown=\"onMousedown\"></canvas>\r\n    <div class=\"center\">{{ this.center[0] + \",\" + this.center[1] }}</div>\r\n    <div class=\"line lineX\"></div>\r\n    <div class=\"line lineY\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { animate } from \"popmotion\";\r\nimport {\r\n  getTileUrl,\r\n  TILE_SIZE,\r\n  getTileRowAndCol,\r\n  lngLatToMercator,\r\n  getPxFromLngLat,\r\n  resolutions,\r\n  mercatorToLngLat,\r\n} from \"./utils\";\r\n\r\n// 瓦片类\r\nclass Tile {\r\n  constructor({ ctx, row, col, zoom, x, y, shouldRender }) {\r\n    // 画布上下文\r\n    this.ctx = ctx;\r\n    // 瓦片行列号\r\n    this.row = row;\r\n    this.col = col;\r\n    // 瓦片层级\r\n    this.zoom = zoom;\r\n    // 显示位置\r\n    this.x = x;\r\n    this.y = y;\r\n    // 判断瓦片是否应该渲染\r\n    this.shouldRender = shouldRender;\r\n    // 瓦片url\r\n    this.url = \"\";\r\n    // 缓存key\r\n    this.cacheKey = this.row + \"_\" + this.col + \"_\" + this.zoom;\r\n    // 图片\r\n    this.img = null;\r\n    // 图片是否加载完成\r\n    this.loaded = false;\r\n    // 图片加载超时定时器\r\n    this.timer = null;\r\n\r\n    this.createUrl();\r\n    this.load();\r\n  }\r\n\r\n  // 生成url\r\n  createUrl() {\r\n    this.url = getTileUrl(this.row, this.col, this.zoom);\r\n  }\r\n\r\n  // 加载图片\r\n  load() {\r\n    this.img = new Image();\r\n    this.img.src = this.url;\r\n    // 加载超时，重新加载\r\n    this.timer = setTimeout(() => {\r\n      this.createUrl();\r\n      this.load();\r\n    }, 1000);\r\n    this.img.onload = () => {\r\n      clearTimeout(this.timer);\r\n      this.loaded = true;\r\n      this.render();\r\n    };\r\n  }\r\n\r\n  // 将图片渲染到canvas上\r\n  render() {\r\n    if (!this.loaded || !this.shouldRender(this.cacheKey)) {\r\n      return;\r\n    }\r\n    this.ctx.drawImage(this.img, this.x, this.y);\r\n  }\r\n\r\n  // 更新位置\r\n  updatePos(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default {\r\n  name: \"App\",\r\n  data() {\r\n    return {\r\n      // 画布宽高\r\n      width: 0,\r\n      height: 0,\r\n      // 鼠标按下标志\r\n      isMousedown: false,\r\n      // 缓存瓦片实例\r\n      tileCache: {},\r\n      // 记录当前画布上需要的瓦片\r\n      currentTileCache: {},\r\n      // 初始中心经纬度\r\n      center: [120.148732, 30.231006], // 雷锋塔\r\n      // 初始缩放层级\r\n      zoom: 17,\r\n\r\n      // 缩放层级范围\r\n      minZoom: 3,\r\n      maxZoom: 18,\r\n      // canvas绘图上下文\r\n      ctx: null,\r\n      // 缩放相关\r\n      lastZoom: 0,\r\n      scale: 1,\r\n      scaleTmp: 1,\r\n      playback: null,\r\n    };\r\n  },\r\n  mounted() {\r\n    this.initCanvas();\r\n    this.renderTiles();\r\n    window.addEventListener(\"mousemove\", this.onMousemove);\r\n    window.addEventListener(\"mouseup\", this.onMouseup);\r\n    window.addEventListener(\"wheel\", this.onMousewheel);\r\n  },\r\n  beforeUnmount() {\r\n    window.removeEventListener(\"mousemove\", this.onMousemove);\r\n    window.removeEventListener(\"mouseup\", this.onMouseup);\r\n    window.removeEventListener(\"wheel\", this.onMousewheel);\r\n  },\r\n  methods: {\r\n    // 初始化画布\r\n    initCanvas() {\r\n      // 获取容器宽高\r\n      let { width, height } = this.$refs.map.getBoundingClientRect();\r\n      this.width = width;\r\n      this.height = height;\r\n      // 设置画布宽高\r\n      let canvas = this.$refs.canvas;\r\n      canvas.width = this.width;\r\n      canvas.height = this.height;\r\n      this.ctx = canvas.getContext(\"2d\");\r\n      // 移动画布原点\r\n      this.ctx.translate(this.width / 2, this.height / 2);\r\n    },\r\n\r\n    // 计算显示范围内的瓦片行列号\r\n    renderTiles() {\r\n      // 中心点对应的瓦片\r\n      let centerTile = getTileRowAndCol(\r\n        ...lngLatToMercator(...this.center),\r\n        this.zoom\r\n      );\r\n      // 中心瓦片左上角对应的像素坐标\r\n      let centerTilePos = [\r\n        centerTile[0] * TILE_SIZE,\r\n        centerTile[1] * TILE_SIZE,\r\n      ];\r\n      // 中心点对应的像素坐标\r\n      let centerPos = getPxFromLngLat(...this.center, this.zoom);\r\n      // 中心像素坐标距中心瓦片左上角的差值\r\n      let offset = [\r\n        centerPos[0] - centerTilePos[0],\r\n        centerPos[1] - centerTilePos[1],\r\n      ];\r\n      // 计算瓦片数量\r\n      let rowMinNum = Math.ceil((this.width / 2 - offset[0]) / TILE_SIZE);\r\n      let colMinNum = Math.ceil((this.height / 2 - offset[1]) / TILE_SIZE);\r\n      let rowMaxNum = Math.ceil(\r\n        (this.width / 2 - (TILE_SIZE - offset[0])) / TILE_SIZE\r\n      );\r\n      let colMaxNum = Math.ceil(\r\n        (this.height / 2 - (TILE_SIZE - offset[1])) / TILE_SIZE\r\n      );\r\n      // 渲染画布内所有瓦片\r\n      this.currentTileCache = {}; // 清空缓存对象\r\n      for (let i = -rowMinNum; i <= rowMaxNum; i++) {\r\n        for (let j = -colMinNum; j <= colMaxNum; j++) {\r\n          // 当前瓦片的行列号\r\n          let row = centerTile[0] + i;\r\n          let col = centerTile[1] + j;\r\n          // 当前瓦片的显示位置\r\n          let x = i * TILE_SIZE - offset[0];\r\n          let y = j * TILE_SIZE - offset[1];\r\n          // 缓存key\r\n          let cacheKey = row + \"_\" + col + \"_\" + this.zoom;\r\n          // 记录当前需要的瓦片\r\n          this.currentTileCache[cacheKey] = true;\r\n          // 该瓦片已加载过\r\n          if (this.tileCache[cacheKey]) {\r\n            this.tileCache[cacheKey].updatePos(x, y).render();\r\n          } else {\r\n            // 未加载过\r\n            this.tileCache[cacheKey] = new Tile({\r\n              ctx: this.ctx,\r\n              row,\r\n              col,\r\n              zoom: this.zoom,\r\n              x,\r\n              y,\r\n              // 判断瓦片是否在当前画布缓存对象上，是的话则代表需要渲染\r\n              shouldRender: (key) => {\r\n                return this.currentTileCache[key];\r\n              },\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    // 清除画布\r\n    clear() {\r\n      this.ctx.clearRect(\r\n        -this.width / 2,\r\n        -this.height / 2,\r\n        this.width,\r\n        this.height\r\n      );\r\n    },\r\n\r\n    // 鼠标按下\r\n    onMousedown(e) {\r\n      if (e.which === 1) {\r\n        this.isMousedown = true;\r\n      }\r\n    },\r\n\r\n    // 鼠标移动\r\n    onMousemove(e) {\r\n      if (!this.isMousedown) {\r\n        return;\r\n      }\r\n      // 计算本次拖动的距离对应的经纬度数据\r\n      let mx = e.movementX * resolutions[this.zoom];\r\n      let my = e.movementY * resolutions[this.zoom];\r\n      let [x, y] = lngLatToMercator(...this.center);\r\n      // 更新拖动后的中心点经纬度\r\n      this.center = mercatorToLngLat(x - mx, my + y);\r\n      // 清除画布重新渲染瓦片\r\n      this.clear();\r\n      this.renderTiles();\r\n    },\r\n\r\n    // 鼠标松开\r\n    onMouseup() {\r\n      this.isMousedown = false;\r\n    },\r\n\r\n    // 鼠标滚动\r\n    onMousewheel(e) {\r\n      if (e.deltaY > 0) {\r\n        // 层级变小\r\n        if (this.zoom > this.minZoom) this.zoom--;\r\n      } else {\r\n        // 层级变大\r\n        if (this.zoom < this.maxZoom) this.zoom++;\r\n      }\r\n      // 层级未发生改变\r\n      if (this.lastZoom === this.zoom) {\r\n        return;\r\n      }\r\n      this.lastZoom = this.zoom;\r\n      // 更新缩放比例，也就是目标缩放值\r\n      this.scale *= e.deltaY > 0 ? 0.5 : 2;\r\n      // 停止上一次动画\r\n      if (this.playback) {\r\n        this.playback.stop();\r\n      }\r\n      // 开启动画\r\n      this.playback = animate({\r\n        from: this.scaleTmp, // 当前缩放值\r\n        to: this.scale, // 目标缩放值\r\n        onUpdate: (latest) => {\r\n          // 实时更新当前缩放值\r\n          this.scaleTmp = latest;\r\n          // 保存画布之前状态，原因有二：\r\n          // 1.scale方法是会在之前的状态上叠加的，比如初始是1，第一次执行scale(2,2)，第二次执行scale(3,3)，最终缩放值不是3，而是6，所以每次缩放完就恢复状态，那么就相当于每次都是从初始值1开始缩放，效果就对了\r\n          // 2.保证缩放效果只对重新渲染已有瓦片生效，不会对最后的renderTiles()造成影响\r\n          this.ctx.save();\r\n          this.clear();\r\n          this.ctx.scale(latest, latest);\r\n          // 刷新当前画布上的瓦片\r\n          Object.keys(this.currentTileCache).forEach((tile) => {\r\n            this.tileCache[tile].render();\r\n          });\r\n          // 恢复到画布之前状态\r\n          this.ctx.restore();\r\n        },\r\n        onComplete: () => {\r\n          // 动画完成后将缩放值重置为1\r\n          this.scale = 1;\r\n          this.scaleTmp = 1;\r\n          // 根据最终缩放值重新计算需要的瓦片并渲染\r\n          this.renderTiles();\r\n        },\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.map {\r\n  position: fixed;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0;\r\n  top: 0;\r\n}\r\n\r\n.line {\r\n  position: absolute;\r\n  background-color: #000;\r\n}\r\n\r\n.lineX {\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 50px;\r\n  height: 2px;\r\n}\r\n\r\n.lineY {\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  height: 50px;\r\n  width: 2px;\r\n}\r\n\r\n.center {\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translateX(-50%);\r\n}\r\n</style>","// 角度转弧度\r\nconst angleToRad = (angle) => {\r\n    return angle * (Math.PI / 180)\r\n}\r\n\r\n// 弧度转角度\r\nconst radToAngle = (rad) => {\r\n    return rad * (180 / Math.PI)\r\n}\r\n\r\n// 地球半径\r\nconst EARTH_RAD = 6378137\r\n\r\n// 4326转3857\r\nexport const lngLatToMercator = (lng, lat) => {\r\n    // 经度先转弧度，然后因为 弧度 = 弧长 / 半径 ，得到弧长为 弧长 = 弧度 * 半径\r\n    let x = angleToRad(lng) * EARTH_RAD\r\n    // 纬度先转弧度\r\n    let rad = angleToRad(lat)\r\n    // 下面我就看不懂了\r\n    let sin = Math.sin(rad)\r\n    let y = (EARTH_RAD / 2) * Math.log((1 + sin) / (1 - sin))\r\n    return [x, y]\r\n}\r\n\r\n// 3857转4326\r\nexport const mercatorToLngLat = (x, y) => {\r\n    let lng = radToAngle(x) / EARTH_RAD\r\n    let lat = radToAngle(2 * Math.atan(Math.exp(y / EARTH_RAD)) - Math.PI / 2)\r\n    return [lng, lat]\r\n}\r\n\r\n// 地球周长\r\nconst EARTH_PERIMETER = 2 * Math.PI * EARTH_RAD\r\n// 瓦片像素\r\nexport const TILE_SIZE = 256\r\n\r\n// 获取某一层级下的分辨率\r\nexport const getResolution = (n) => {\r\n    const tileNums = Math.pow(2, n)\r\n    const tileTotalPx = tileNums * TILE_SIZE\r\n    return EARTH_PERIMETER / tileTotalPx\r\n}\r\n\r\n// 分辨率列表\r\nexport const resolutions = []\r\nfor (let i = 0; i <= 18; i++) {\r\n    resolutions.push(getResolution(i))\r\n}\r\n\r\n// 转换3857坐标的原点\r\nexport const transformXY = (x, y, origin = 'topLeft') => {\r\n    if (origin === 'topLeft') {\r\n        x += EARTH_PERIMETER / 2\r\n        y = EARTH_PERIMETER / 2 - y\r\n    }\r\n    return [x, y]\r\n}\r\n\r\n// 根据4326坐标及缩放层级计算瓦片行列号\r\nexport const getTileRowAndCol = (lng, lat, z, opt = {}) => {\r\n    let [x, y] = transformXY(...(opt.lngLatToMercator || lngLatToMercator)(lng, lat), opt.origin)\r\n    let resolution = (opt.resolutions || resolutions)[z]\r\n    let row = Math.floor(x / resolution / TILE_SIZE)\r\n    let col = Math.floor(y / resolution / TILE_SIZE)\r\n    return [row, col]\r\n}\r\n\r\n// 计算4326经纬度对应的像素坐标\r\nexport const getPxFromLngLat = (lng, lat, z, opt = {}) => {\r\n    let [_x, _y] = transformXY(...(opt.lngLatToMercator || lngLatToMercator)(lng, lat), opt.origin)\r\n    let resolution = (opt.resolutions || resolutions)[z]\r\n    let x = Math.floor(_x / resolution)\r\n    let y = Math.floor(_y / resolution)\r\n    return [x, y]\r\n}\r\n\r\n// 拼接瓦片地址\r\nexport const getTileUrl = (x, y, z) => {\r\n    let domainIndexList = [1, 2, 3, 4]\r\n    let domainIndex =\r\n        domainIndexList[Math.floor(Math.random() * domainIndexList.length)]\r\n    return `https://webrd0${domainIndex}.is.autonavi.com/appmaptile?x=${x}&y=${y}&z=${z}&lang=zh_cn&size=1&scale=1&style=8`\r\n}\r\n\r\n// 随机获取url子域索引\r\nexport const getRandomDomainIndex = (url) => {\r\n    // 检查是否支持多个子域\r\n    let res = url.match(/\\{[\\d-]+\\}/)\r\n    if (res) {\r\n        let arr = res[0].slice(1, -1).split(/\\s*-\\s*/)\r\n        let domainIndexList = []\r\n        for (let i = Number(arr[0]); i <= Number(arr[1]); i++) {\r\n            domainIndexList.push(i)\r\n        }\r\n        return domainIndexList[Math.floor(Math.random() * domainIndexList.length)]\r\n    }\r\n    return null\r\n}\r\n\r\n// 拼接瓦片地址\r\nexport const getTileUrlPro = (x, y, z, url, {transformXYZ, getTileUrl} = {}) => {\r\n    // 检查是否支持多个子域\r\n    let domainIndex = getRandomDomainIndex(url)\r\n    if (domainIndex !== '') {\r\n        url = url.replace(/\\{[\\d-]+\\}/, domainIndex)\r\n    }\r\n    // 自定义url拼接方法\r\n    if (getTileUrl) {\r\n        return getTileUrl(x, y, z)\r\n    }\r\n    // 转换x、y、z\r\n    if (transformXYZ) {\r\n        let res = transformXYZ(x, y, z)\r\n        x = res[0]\r\n        y = res[1]\r\n        z = res[2]\r\n    }\r\n    return url.replace('{x}', x).replace('{y}', y).replace('{z}', z)\r\n}\r\n\r\nexport const KEY = '0913a20b5d5a703b920e1ff0d9d26559'","import { render } from \"./Old.vue?vue&type=template&id=7f5862c5&scoped=true\"\nimport script from \"./Old.vue?vue&type=script&lang=js\"\nexport * from \"./Old.vue?vue&type=script&lang=js\"\n\nimport \"./Old.vue?vue&type=style&index=0&id=7f5862c5&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\works\\\\学习\\\\web_map_demo\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7f5862c5\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"map\" ref=\"map\">\r\n    <div class=\"mapBox\" ref=\"mapBox\" @mousedown=\"onMousedown\"></div>\r\n    <!-- 中心点十字架 -->\r\n    <div class=\"line lineX\"></div>\r\n    <div class=\"line lineY\"></div>\r\n    <!-- 搜索框 -->\r\n    <div class=\"searchBox\">\r\n      <div class=\"searchInput\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"搜索...\"\r\n          v-model=\"searchText\"\r\n          @input=\"onSearch\"\r\n          @keyup.enter=\"onSearch\"\r\n          @click.stop\r\n        />\r\n      </div>\r\n      <div class=\"searchList\">\r\n        <div\r\n          class=\"searchItem\"\r\n          v-for=\"(item, index) in searchResultList\"\r\n          :key=\"index\"\r\n          @click=\"go(item.location)\"\r\n        >\r\n          {{ item.name }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"mapTypeSelectBox\">\r\n      <select v-model=\"selectMapType\" @change=\"onSelectMapTypeChange\">\r\n        <option v-for=\"item in mapList\" :key=\"item.value\" :value=\"item.value\">{{item.name}}</option>\r\n      </select>\r\n    </div>\r\n    <!-- 经纬度框 -->\r\n    <div class=\"posInput\">\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"经纬度...\"\r\n        v-model=\"posValue\"\r\n        @keyup.enter=\"onChangePos\"\r\n        @click.stop\r\n      />\r\n    </div>\r\n    <!-- 返回到初始中心点按钮 -->\r\n    <div class=\"backCenterBtn\" @click.stop=\"backCenter\"></div>\r\n    <!-- 放大缩小按钮 -->\r\n    <div class=\"scaleBtnBox\">\r\n      <div\r\n        class=\"scaleBtn in\"\r\n        :class=\"{ disabled: zoom >= maxZoom }\"\r\n        @click.stop=\"zoomIn\"\r\n      ></div>\r\n      <div\r\n        class=\"scaleBtn out\"\r\n        :class=\"{ disabled: zoom <= minZoom }\"\r\n        @click.stop=\"zoomOut\"\r\n      ></div>\r\n    </div>\r\n    <!-- 叠加物 -->\r\n    <img class=\"overlay\" src=\"./assets/camera.png\" :style=\"{left: overlayPos.x + 'px', top: overlayPos.y + 'px'}\" alt=\"\">\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { animate, easeOut } from \"popmotion\";\r\nimport Konva from \"konva\";\r\nimport {\r\n  getTileUrlPro,\r\n  TILE_SIZE,\r\n  getTileRowAndCol,\r\n  lngLatToMercator,\r\n  getPxFromLngLat,\r\n  resolutions,\r\n  mercatorToLngLat,\r\n  KEY,\r\n  getRandomDomainIndex\r\n} from \"./utils\";\r\nimport gcoord from 'gcoord';\r\n\r\n// 图片加载类\r\nclass Img {\r\n  constructor(url, onload) {\r\n    this.timer = null;\r\n    this.url = url;\r\n    this.onload = onload;\r\n    this.called = false\r\n    this.reloadTimes = 0;\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    if (this.reloadTimes >= 5) {\r\n      if (!this.called) {\r\n        this.onload(null);\r\n        this.called = true\r\n      }\r\n      return\r\n    }\r\n    this.reloadTimes++\r\n    let img = new Image();\r\n    img.src = this.url;\r\n    // 加载超时，重新加载\r\n    this.timer = setTimeout(() => {\r\n      this.load();\r\n    }, 1000);\r\n    // 加载完成\r\n    img.onload = () => {\r\n      clearTimeout(this.timer);\r\n      if (!this.called) {\r\n        this.onload(img);\r\n        this.called = true\r\n      }\r\n    };\r\n    img.onerror = () => {\r\n      this.load();\r\n    }\r\n  }\r\n}\r\n\r\n// 瓦片类\r\nclass Tile {\r\n  constructor({ layer, row, col, zoom, x, y, shouldRender, getMapTypeData }) {\r\n    // 瓦片显示图层\r\n    this.layer = layer;\r\n    // 瓦片行列号\r\n    this.row = row;\r\n    this.col = col;\r\n    // 瓦片层级\r\n    this.zoom = zoom;\r\n    // 显示位置\r\n    this.x = x;\r\n    this.y = y;\r\n    // 判断瓦片是否应该渲染\r\n    this.shouldRender = shouldRender;\r\n    // 获取当前地图类型数据\r\n    this.getMapTypeData = getMapTypeData;\r\n    // 瓦片url\r\n    this.urls = [];\r\n    // 缓存key\r\n    this.cacheKey = this.row + \"_\" + this.col + \"_\" + this.zoom;\r\n    // 瓦片图片\r\n    this.imgs = [];\r\n    // 瓦片透明度\r\n    this.opacity = 0;\r\n    // 图片是否加载完成\r\n    this.loaded = false;\r\n    // 图片加载超时定时器\r\n    this.timer = null;\r\n    // 瓦片渐现过渡时间\r\n    this.fadeInDuration = 400;\r\n\r\n    this.createUrl();\r\n    this.load();\r\n  }\r\n\r\n  // 生成url\r\n  createUrl() {\r\n    let mapData = this.getMapTypeData()\r\n    this.urls = mapData.urls.map((url) => {\r\n      return getTileUrlPro(this.row, this.col, this.zoom, url, {getTileUrl: mapData.getTileUrl, transformXYZ: mapData.transformXYZ})\r\n    });\r\n  }\r\n\r\n  // 加载图片\r\n  load() {\r\n    let tasks = this.urls.map((url, index) => {\r\n      return new Promise((resolve) => {\r\n        new Img(url, (img) => {\r\n          if (img) {\r\n            this.imgs[index] = new Konva.Image({\r\n              image: img,\r\n              width: TILE_SIZE,\r\n              height: TILE_SIZE,\r\n              opacity: this.opacity,\r\n            })\r\n          }\r\n          resolve()\r\n        })\r\n      })\r\n    })\r\n    Promise.all(tasks)\r\n      .then(() => {\r\n        this.loaded = true\r\n        this.render()\r\n      })\r\n  }\r\n\r\n  // 渲染\r\n  render(isFadeIn = false) {\r\n    if (!this.loaded || this.imgs.length <= 0 || !this.shouldRender(this.cacheKey)) {\r\n      return;\r\n    }\r\n    // 添加到图层\r\n    this.imgs.forEach((img) => {\r\n      if (img) {\r\n        this.layer.add(img);\r\n        // 设置显示位置\r\n        img.x(this.x).y(this.y);\r\n      }\r\n    });\r\n    // 需要渐现\r\n    if (isFadeIn && this.opacity !== 0) {\r\n      this.hide();\r\n    }\r\n    this.fadeIn();\r\n  }\r\n\r\n  // 渐现\r\n  fadeIn() {\r\n    if (this.opacity >= 1 || this.imgs.length <= 0) {\r\n      return;\r\n    }\r\n    let base = this.opacity;\r\n    let anim = new Konva.Animation((frame) => {\r\n      let opacity = (frame.time / this.fadeInDuration) * 1 + base;\r\n      this.opacity = opacity;\r\n      this.imgs.forEach((img) => {\r\n        if (img) {\r\n          img.opacity(opacity);\r\n        }\r\n      });\r\n      if (opacity >= 1) {\r\n        anim.stop();\r\n      }\r\n    }, this.layer);\r\n    anim.start();\r\n  }\r\n\r\n  // 隐藏\r\n  hide() {\r\n    if (this.imgs.length <= 0) {\r\n      return\r\n    }\r\n    this.opacity = 0;\r\n    this.imgs.forEach((img) => {\r\n      if (img) {\r\n        img.opacity(0);\r\n      }\r\n    });\r\n  }\r\n\r\n  // 更新要添加到的图层\r\n  updateLayer(layer) {\r\n    this.layer = layer;\r\n    return this;\r\n  }\r\n\r\n  // 更新位置\r\n  updatePos(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default {\r\n  name: \"App\",\r\n  data() {\r\n    return {\r\n      // 画布宽高\r\n      width: 0,\r\n      height: 0,\r\n      // 鼠标按下标志\r\n      isMousedown: false,\r\n      lastMouseTime: null,\r\n      lastDuration: 0,\r\n      lastDistance: [],\r\n      // 缓存瓦片实例\r\n      tileCache: {},\r\n      // 记录当前画布上需要的瓦片\r\n      currentTileCache: {},\r\n      // 初始中心经纬度\r\n      initCenter: [120.148732, 30.231006], // 雷锋塔\r\n      center: [120.148732, 30.231006], // 雷锋塔\r\n      // 初始缩放层级\r\n      zoom: 14,\r\n      // 缩放层级范围\r\n      minZoom: 3,\r\n      maxZoom: 18,\r\n      // 缩放相关\r\n      lastZoom: 0,\r\n      scale: 1,\r\n      scaleTmp: 1,\r\n      playback: null,\r\n      // 图层相关\r\n      stage: null,\r\n      layer1: null,\r\n      layer2: null,\r\n      useLayer1: true,\r\n      // 搜索&移动\r\n      searchText: \"\",\r\n      searchTimer: null,\r\n      searchResultList: [],\r\n      translate: [0, 0],\r\n      translateTmp: [0, 0],\r\n      translatePlayback: null,\r\n      // 经纬度框\r\n      posValue: \"\",\r\n      // 地图类型\r\n      selectMapType: '',\r\n      selectMapData: null,\r\n      mapList: [\r\n        {\r\n          name: '高德地图',\r\n          value: 'gaode',\r\n          urls: ['https://webrd0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&lang=zh_cn&size=1&scale=1&style=8'],\r\n        },\r\n        {\r\n          name: '高德影像图',\r\n          value: 'gaodeImage',\r\n          urls: ['https://webst0{1-4}.is.autonavi.com/appmaptile?x={x}&y={y}&z={z}&style=6', 'https://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=8&x={x}&y={y}&z={z}&scl=1&ltype=4']\r\n        },\r\n        {\r\n          name: '百度地图',\r\n          value: 'baidu',\r\n          urls: ['https://maponline2.bdimg.com/tile/?qt=vtile&x={x}&y={y}&z={z}&styles=pl&scaler=2&udt=&from=jsapi2_0'],\r\n          origin: 'center',// 坐标系原点\r\n          axis: ['right', 'top'],// 坐标轴方向\r\n          resolutions: function(){// 自定义分辨率\r\n            let resolutions = [];\r\n            for (let i = 0; i <= 18; i++) {\r\n                resolutions[i] = Math.pow(2, 18 - i);\r\n            }\r\n            return resolutions\r\n          }(),\r\n          // 自定义经纬度和墨卡托坐标转换方法\r\n          lngLatToMercator(lng, lat) {\r\n            return gcoord.transform(\r\n              [lng, lat],\r\n              gcoord.GCJ02,\r\n              gcoord.BD09MC\r\n            )\r\n          },\r\n          mercatorToLngLat(lng, lat) {\r\n            return gcoord.transform(\r\n              [lng, lat],\r\n              gcoord.BD09MC,\r\n              gcoord.GCJ02\r\n            )\r\n          }\r\n        },\r\n        {\r\n          name: '腾讯地图',\r\n          value: 'tx',\r\n          urls: ['https://rt{1-3}.map.gtimg.com/tile?z={z}&x={x}&y={y}&styleid=1&scene=0'],\r\n          transformXYZ(x, y, z) {\r\n            // 原点从左上角转换成左下角\r\n            y = Math.pow(2, z) - y - 1\r\n            return [x, y, z]\r\n          }\r\n        },\r\n        {\r\n          name: 'GeoQ',\r\n          value: 'geoq',\r\n          urls: ['http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}']\r\n        },\r\n        {\r\n          name: '天地图',\r\n          value: 'tianditu',\r\n          urls: ['http://t{0-7}.tianditu.com/DataServer?T=vec_w&tk=2c009e76130364aaf09aa30ef0621154&x={x}&y={y}&l={z}', 'http://t3.tianditu.com/DataServer?T=cva_w&tk=2c009e76130364aaf09aa30ef0621154&x={x}&y={y}&l={z}'],\r\n          // 需要火星坐标系转4326\r\n          transformLngLat(lng, lat) {\r\n            return gcoord.transform(\r\n              [lng, lat],\r\n              gcoord.GCJ02,\r\n              gcoord.WGS84\r\n            );\r\n          }\r\n        },\r\n        {\r\n          name: '必应中文',\r\n          value: 'bing',\r\n          urls: [''],\r\n          getTileUrl(x, y, z) {\r\n            let result = '', zIndex = 0\r\n            for (; zIndex < z; zIndex++) {\r\n                result = ((x & 1) + 2 * (y & 1)).toString() + result\r\n                x >>= 1\r\n                y >>= 1\r\n            }\r\n            let domainIndex = getRandomDomainIndex('http://dynamic.t{0-3}.tiles.ditu.live.com/comp/ch/')\r\n            return `http://dynamic.t${domainIndex}.tiles.ditu.live.com/comp/ch/${result}?it=G,VE,BX,L,LA&mkt=zh-cn,syr&n=z&og=111&ur=CN`\r\n          }\r\n        },\r\n      ],\r\n      // 叠加物\r\n      overlayPos: {\r\n        x: 0,\r\n        y: 0\r\n      },\r\n      startOverlayPos: {\r\n        x: 0,\r\n        y: 0\r\n      },\r\n      overlayCood: [120.1829784447035,30.243167147657232]\r\n    };\r\n  },\r\n  watch: {\r\n    center(val) {\r\n      this.posValue = val.join(\",\");\r\n    }\r\n  },\r\n  created() {\r\n    this.selectMapType = this.mapList[0].value\r\n    this.changeMapType()\r\n  },\r\n  async mounted() {\r\n    this.init();\r\n    this.renderTiles();\r\n    window.addEventListener(\"mousemove\", this.onMousemove);\r\n    window.addEventListener(\"mouseup\", this.onMouseup);\r\n    window.addEventListener(\"wheel\", this.onMousewheel);\r\n  },\r\n  beforeUnmount() {\r\n    window.removeEventListener(\"mousemove\", this.onMousemove);\r\n    window.removeEventListener(\"mouseup\", this.onMouseup);\r\n    window.removeEventListener(\"wheel\", this.onMousewheel);\r\n  },\r\n  methods: {\r\n    // 地图类型切换事件\r\n    onSelectMapTypeChange() {\r\n      this.changeMapType()\r\n      this.tileCache = {}\r\n      this.currentTileCache = {}\r\n      this.clearLayer()\r\n      this.renderTiles()\r\n    },\r\n\r\n    // 修改地图类型\r\n    changeMapType() {\r\n      this.selectMapData = this.mapList.find((item) => {\r\n        return item.value === this.selectMapType\r\n      })\r\n    },\r\n\r\n    // 初始化\r\n    init() {\r\n      // 获取容器宽高\r\n      let { width, height } = this.$refs.mapBox.getBoundingClientRect();\r\n      this.width = width;\r\n      this.height = height;\r\n\r\n      // 创建舞台\r\n      this.stage = new Konva.Stage({\r\n        container: this.$refs.mapBox,\r\n        width,\r\n        height,\r\n      });\r\n\r\n      // 创建两个图层\r\n      this.layer1 = new Konva.Layer();\r\n      this.layer1.x(this.width / 2).y(this.height / 2);\r\n      this.stage.add(this.layer1);\r\n\r\n      this.layer2 = new Konva.Layer();\r\n      this.layer2.x(this.width / 2).y(this.height / 2);\r\n      this.stage.add(this.layer2);\r\n    },\r\n\r\n    // 计算显示范围内的瓦片行列号\r\n    renderTiles(isFadeIn = false) {\r\n      let center = this.center\r\n      // 需要转换经纬度\r\n      if (this.selectMapData.transformLngLat) {\r\n        center = this.selectMapData.transformLngLat(...this.center)\r\n      }\r\n      // 地图自定义数据\r\n      let plusOpt = {\r\n        origin: this.selectMapData.origin,\r\n        resolutions: this.selectMapData.resolutions,\r\n        lngLatToMercator: this.selectMapData.lngLatToMercator\r\n      }\r\n      // 中心点对应的瓦片\r\n      let centerTile = getTileRowAndCol(...center, this.zoom, plusOpt);\r\n      // 中心瓦片左上角对应的像素坐标\r\n      let centerTilePos = [\r\n        centerTile[0] * TILE_SIZE,\r\n        centerTile[1] * TILE_SIZE,\r\n      ];\r\n      // 中心点对应的像素坐标\r\n      let centerPos = getPxFromLngLat(...center, this.zoom, plusOpt);\r\n      // 中心像素坐标距中心瓦片左上/下角的差值\r\n      let offset = [\r\n        centerPos[0] - centerTilePos[0],\r\n        centerPos[1] - centerTilePos[1],\r\n      ];\r\n      // 计算瓦片数量\r\n      let rowMinNum = Math.ceil((this.width / 2 - offset[0]) / TILE_SIZE);\r\n      let colMinNum = Math.ceil((this.height / 2 - offset[1]) / TILE_SIZE);\r\n      let rowMaxNum = Math.ceil(\r\n        (this.width / 2 - (TILE_SIZE - offset[0])) / TILE_SIZE\r\n      );\r\n      let colMaxNum = Math.ceil(\r\n        (this.height / 2 - (TILE_SIZE - offset[1])) / TILE_SIZE\r\n      );\r\n      // y轴向上\r\n      let axisYIsTop = this.selectMapData.axis ? this.selectMapData.axis[1] === 'top' : false\r\n      this.currentTileCache = {}; // 清空缓存对象\r\n      // 渲染画布内所有瓦片\r\n      for (let i = -rowMinNum; i <= rowMaxNum; i++) {\r\n        for (let j = -colMinNum; j <= colMaxNum; j++) {\r\n          // 当前瓦片的行列号\r\n          let row = centerTile[0] + i;\r\n          let col = centerTile[1] + j;\r\n          // 当前瓦片的显示位置\r\n          let _j = j\r\n          // 百度地图，坐标系和画布坐标系y轴相反\r\n          if (axisYIsTop && j !== 0) {\r\n            _j = -j\r\n          }\r\n          let x = i * TILE_SIZE - offset[0];\r\n          // 百度地图的offset[1]是中心点距中心瓦片左下角的距离，需要换算成左上角的y值\r\n          let y = _j * TILE_SIZE - (axisYIsTop ? TILE_SIZE - offset[1] : offset[1]);\r\n          // 缓存key\r\n          let cacheKey = row + \"_\" + col + \"_\" + this.zoom;\r\n          // 记录当前需要的瓦片\r\n          this.currentTileCache[cacheKey] = true;\r\n          // 该瓦片已加载过\r\n          let layer = this.getCurrentMainLayer();\r\n          if (this.tileCache[cacheKey]) {\r\n            this.tileCache[cacheKey]\r\n              .updateLayer(layer)\r\n              .updatePos(x, y)\r\n              .render(isFadeIn);\r\n          } else {\r\n            // 未加载过\r\n            this.tileCache[cacheKey] = new Tile({\r\n              layer,\r\n              row,\r\n              col,\r\n              zoom: this.zoom,\r\n              x,\r\n              y,\r\n              // 判断瓦片是否在当前画布缓存对象上，是的话则代表需要渲染\r\n              shouldRender: (key) => {\r\n                return this.currentTileCache[key];\r\n              },\r\n              // 获取当前地图类型\r\n              getMapTypeData: () => {\r\n                return this.selectMapData\r\n              }\r\n            });\r\n          }\r\n        }\r\n      }\r\n      // 渲染叠加物\r\n      this.renderOverlay();\r\n    },\r\n\r\n    // 显示叠加物\r\n    renderOverlay() {\r\n      // 中心点转换成像素坐标\r\n      let centerPos = (this.selectMapData.lngLatToMercator || lngLatToMercator)(...this.center);\r\n      // 叠加物转成像素坐标\r\n      let overlayPos = (this.selectMapData.lngLatToMercator || lngLatToMercator)(...this.overlayCood);\r\n      //叠加物距离中心点的像素差值\r\n      let offset = [\r\n        (overlayPos[0] - centerPos[0]) / (this.selectMapData.resolutions || resolutions)[this.zoom],\r\n        (overlayPos[1] - centerPos[1]) / (this.selectMapData.resolutions || resolutions)[this.zoom]\r\n      ]\r\n      this.overlayPos.x = offset[0] + this.width / 2\r\n      this.overlayPos.y = this.height / 2 - offset[1]\r\n    },\r\n\r\n    // 清空图层\r\n    clearLayer() {\r\n      this.layer1.removeChildren();\r\n      this.layer2.removeChildren();\r\n    },\r\n\r\n    // 重置图层\r\n    resetLayer() {\r\n      // 如果当前元素显示在图层1，那么即将切换为图层2，所以将图层二的缩放复位、清空旧的元素、置顶显示，反之亦然\r\n      let currentLayer = this.getCurrentMainLayer();\r\n      let willLayer = this.useLayer1 ? this.layer2 : this.layer1;\r\n      willLayer.scale({\r\n        x: 1,\r\n        y: 1,\r\n      });\r\n      willLayer.x(this.width / 2).y(this.height / 2);\r\n      willLayer.removeChildren();\r\n      currentLayer.zIndex(0);\r\n      willLayer.zIndex(1);\r\n      // 重置叠加物\r\n      this.startOverlayPos = {\r\n        x: this.overlayPos.x,\r\n        y: this.overlayPos.y\r\n      }\r\n    },\r\n\r\n    // 鼠标按下\r\n    onMousedown(e) {\r\n      if (e.which === 1) {\r\n        this.isMousedown = true;\r\n      }\r\n    },\r\n\r\n    // 鼠标移动\r\n    onMousemove(e) {\r\n      if (!this.isMousedown) {\r\n        return;\r\n      }\r\n      // 记录本次拖动的时间段及偏移量\r\n      let curTime = Date.now();\r\n      if (this.lastMouseTime) {\r\n        this.lastDuration = curTime - this.lastMouseTime;\r\n        this.lastDistance = [e.movementX, e.movementY]\r\n      }\r\n      this.lastMouseTime = curTime;\r\n      // 计算本次拖动的距离对应的经纬度数据\r\n      let mx = e.movementX * (this.selectMapData.resolutions || resolutions)[this.zoom];\r\n      let my = e.movementY * (this.selectMapData.resolutions || resolutions)[this.zoom];\r\n      let [x, y] = (this.selectMapData.lngLatToMercator || lngLatToMercator)(...this.center);\r\n      // 更新拖动后的中心点经纬度\r\n      this.center = (this.selectMapData.mercatorToLngLat || mercatorToLngLat)(x - mx, my + y);\r\n      // 清除画布重新渲染瓦片\r\n      this.clearLayer();\r\n      this.renderTiles();\r\n    },\r\n\r\n    // 鼠标松开\r\n    onMouseup() {\r\n      this.isMousedown = false;\r\n      this.momentum();\r\n    },\r\n\r\n    // 检查是否需要动量动画\r\n    momentum() {\r\n      if (this.lastDuration <= 0) {\r\n        this.resetTranslate();\r\n        return\r\n      }\r\n      // 计算最后时刻鼠标滑动的速度\r\n      let speedX = this.lastDistance[0] / this.lastDuration;\r\n      let speedY = this.lastDistance[1] / this.lastDuration;\r\n      // 小于该速度则不进行动量动画\r\n      if (Math.abs(speedX) <= 0.3 && Math.abs(speedY) <= 0.3) {\r\n        this.resetTranslate();\r\n        return\r\n      }\r\n      this.translate = [this.translateTmp[0] + speedX / 0.005, this.translateTmp[1] + speedY / 0.005];\r\n      this.resetLayer();\r\n      if (this.translatePlayback) {\r\n        this.translatePlayback.stop();\r\n      }\r\n      this.translatePlayback = animate({\r\n        from: this.translateTmp.join(\" \"),\r\n        to: this.translate.join(\" \"),\r\n        ease: easeOut,\r\n        duration: 300 + (Math.abs(speedX) + Math.abs(speedY))/2 * 100,\r\n        onUpdate: (latest) => {\r\n          this.translateTmp = this.stringValueToArray(latest);\r\n          let layer = this.getCurrentMainLayer();\r\n          // 画布移动\r\n          layer\r\n            .x(this.width / 2 + this.translateTmp[0])\r\n            .y(this.height / 2 + this.translateTmp[1]);\r\n          // 叠加物移动\r\n          this.overlayPos.x = this.startOverlayPos.x + this.translateTmp[0]\r\n          this.overlayPos.y = this.startOverlayPos.y + this.translateTmp[1]\r\n        },\r\n        onComplete: () => {\r\n          // 计算本次拖动的距离对应的经纬度数据\r\n          let mx = this.translate[0] * (this.selectMapData.resolutions || resolutions)[this.zoom];\r\n          let my = this.translate[1] * (this.selectMapData.resolutions || resolutions)[this.zoom];\r\n          let [x, y] = (this.selectMapData.lngLatToMercator || lngLatToMercator)(...this.center);\r\n          // 更新拖动后的中心点经纬度\r\n          this.center = (this.selectMapData.mercatorToLngLat || mercatorToLngLat)(x - mx, my + y);\r\n          this.useLayer1 = !this.useLayer1;\r\n          this.resetTranslate();\r\n          // 当前不在画布上的瓦片透明度都恢复成0\r\n          this.hideTiles();\r\n          // 重新渲染瓦片\r\n          this.renderTiles();\r\n        },\r\n      });\r\n    },\r\n\r\n    // 鼠标滚动\r\n    onMousewheel(e) {\r\n      if (e.deltaY > 0) {\r\n        this.zoomOut();\r\n      } else {\r\n        this.zoomIn();\r\n      }\r\n    },\r\n\r\n    // 放大\r\n    zoomIn() {\r\n      this.scaleMap(true);\r\n    },\r\n\r\n    // 缩小\r\n    zoomOut() {\r\n      this.scaleMap(false);\r\n    },\r\n\r\n    // 缩放\r\n    scaleMap(zoomIn) {\r\n      if (!zoomIn) {\r\n        // 层级变小\r\n        if (this.zoom > this.minZoom) this.zoom--;\r\n      } else {\r\n        // 层级变大\r\n        if (this.zoom < this.maxZoom) this.zoom++;\r\n      }\r\n      // 层级未发生改变\r\n      if (this.lastZoom === this.zoom) {\r\n        return;\r\n      }\r\n      this.lastZoom = this.zoom;\r\n      // 更新缩放比例，也就是目标缩放值\r\n      this.scale *= !zoomIn > 0 ? 0.5 : 2;\r\n      // 停止上一次动画\r\n      if (this.playback) {\r\n        this.playback.stop();\r\n      }\r\n      // 图层重置\r\n      this.resetLayer();\r\n      // 开启动画\r\n      this.playback = animate({\r\n        from: this.scaleTmp, // 当前缩放值\r\n        to: this.scale, // 目标缩放值\r\n        duration: 500,\r\n        onUpdate: (latest) => {\r\n          // 实时更新当前缩放值\r\n          this.scaleTmp = latest;\r\n          let layer = this.getCurrentMainLayer();\r\n          layer.scale({\r\n            x: latest,\r\n            y: latest,\r\n          });\r\n          // 叠加物移动\r\n          // 叠加物坐标系原点在左上角，画布坐标系原点在中间，缩放是以中间为原点进行缩放，所以先把屏幕坐标转换成画布坐标，缩放完后再转回去\r\n          let x = (this.startOverlayPos.x - this.width / 2) * latest\r\n          let y = (this.startOverlayPos.y - this.height / 2) * latest\r\n          this.overlayPos.x = x + this.width / 2\r\n          this.overlayPos.y = y + this.height / 2\r\n        },\r\n        onComplete: () => {\r\n          // 切换图层\r\n          this.useLayer1 = !this.useLayer1;\r\n          // 动画完成后将缩放值重置为1\r\n          this.scale = 1;\r\n          this.scaleTmp = 1;\r\n          // 根据最终缩放值重新计算需要的瓦片并渲染\r\n          this.renderTiles(true);\r\n        },\r\n      });\r\n    },\r\n\r\n    // 搜索\r\n    onSearch() {\r\n      clearTimeout(this.searchTimer);\r\n      this.searchTimer = setTimeout(() => {\r\n        if (this.searchText.trim()) {\r\n          fetch(\r\n            `https://restapi.amap.com/v3/assistant/inputtips?key=${KEY}&keywords=${this.searchText.trim()}`\r\n          )\r\n            .then((response) => {\r\n              return response.json();\r\n            })\r\n            .then((response) => {\r\n              this.searchResultList = response.tips || [];\r\n            });\r\n        } else {\r\n          this.searchResultList = [];\r\n        }\r\n      }, 300);\r\n    },\r\n\r\n    // 定位到指定位置\r\n    go(newCenter) {\r\n      if (this.translatePlayback) {\r\n        return;\r\n      }\r\n      if (typeof newCenter === \"string\") {\r\n        newCenter = newCenter.split(\",\").map((item) => {\r\n          return Number(item);\r\n        });\r\n      }\r\n      // 目标位置经纬度转3857坐标\r\n      let newCenterMercator = (this.selectMapData.lngLatToMercator || lngLatToMercator)(...newCenter);\r\n      // 当前经纬度转3857坐标\r\n      let centerMercator = (this.selectMapData.lngLatToMercator || lngLatToMercator)(...this.center);\r\n      // 计算两者的距离，转换成像素\r\n      this.translate = [\r\n        (newCenterMercator[0] - centerMercator[0]) / (this.selectMapData.resolutions || resolutions)[this.zoom],\r\n        (newCenterMercator[1] - centerMercator[1]) / (this.selectMapData.resolutions || resolutions)[this.zoom],\r\n      ];\r\n      // 重置画布\r\n      this.resetLayer();\r\n      // 开启动画\r\n      this.translatePlayback = animate({\r\n        from: this.translateTmp.join(\" \"),\r\n        to: this.translate.join(\" \"),\r\n        duration: 1000,\r\n        onUpdate: (latest) => {\r\n          this.translateTmp = this.stringValueToArray(latest);\r\n          let layer = this.getCurrentMainLayer();\r\n          // 画布移动\r\n          layer\r\n            .x(this.width / 2 - this.translateTmp[0])\r\n            .y(this.height / 2 + this.translateTmp[1]);\r\n          // 叠加物移动\r\n          this.overlayPos.x = this.startOverlayPos.x - this.translateTmp[0]\r\n          this.overlayPos.y = this.startOverlayPos.y + this.translateTmp[1]\r\n        },\r\n        onComplete: () => {\r\n          // 中心点更新为目标经纬度\r\n          this.center = newCenter;\r\n          this.useLayer1 = !this.useLayer1;\r\n          this.resetTranslate();\r\n          // 当前不在画布上的瓦片透明度都恢复成0\r\n          this.hideTiles();\r\n          // 重新渲染瓦片\r\n          this.renderTiles();\r\n        },\r\n      });\r\n    },\r\n\r\n    // 复位滑动变量\r\n    resetTranslate() {\r\n      this.translatePlayback = null;\r\n      this.translateTmp = [0, 0];\r\n      this.translate = [0, 0];\r\n      this.lastMouseTime = null;\r\n      this.lastDuration = 0;\r\n      this.lastDistance = [];\r\n    },\r\n\r\n    // 当前不在画布上的瓦片透明度都恢复成0\r\n    hideTiles() {\r\n      Object.keys(this.tileCache).forEach((cacheKey) => {\r\n        if (!this.currentTileCache[cacheKey]) {\r\n          this.tileCache[cacheKey].hide();\r\n        }\r\n      });\r\n    },\r\n\r\n    // 空格分隔的字符串转数字数组\r\n    stringValueToArray(latest) {\r\n      return latest.split(\" \").map((item) => {\r\n        return Number(item);\r\n      });\r\n    },\r\n\r\n    // 获取当前的主画布图层\r\n    getCurrentMainLayer() {\r\n      return this.useLayer1 ? this.layer1 : this.layer2;\r\n    },\r\n\r\n    // 回到初始位置\r\n    backCenter() {\r\n      this.go(this.initCenter);\r\n    },\r\n\r\n    // 切换经纬度\r\n    onChangePos() {\r\n      this.go(this.posValue);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.map {\r\n  position: fixed;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0;\r\n  top: 0;\r\n  background-color: rgb(244, 244, 244);\r\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAYAAADL1t+KAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTI0RTg4NzlGRDk5MTFFNjlDNTFBODNCMUQwNzgyQjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTI0RTg4N0FGRDk5MTFFNjlDNTFBODNCMUQwNzgyQjgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMjRFODg3N0ZEOTkxMUU2OUM1MUE4M0IxRDA3ODJCOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMjRFODg3OEZEOTkxMUU2OUM1MUE4M0IxRDA3ODJCOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmlSGaMAAAujSURBVHja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);\r\n  background-repeat: repeat;\r\n}\r\n\r\n.map * {\r\n  margin: 0;\r\n  padding: 0;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.mapBox {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.line {\r\n  position: absolute;\r\n  background-color: #000;\r\n}\r\n\r\n.lineX {\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  width: 50px;\r\n  height: 2px;\r\n}\r\n\r\n.lineY {\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translate(-50%, -50%);\r\n  height: 50px;\r\n  width: 2px;\r\n}\r\n\r\n.center {\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 50%;\r\n  transform: translateX(-50%);\r\n}\r\n\r\n.mapTypeSelectBox {\r\n  position: absolute;\r\n  left: 230px;\r\n  top: 20px;\r\n  width: 100px;\r\n  height: 30px;\r\n}\r\n\r\n.mapTypeSelectBox select {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.searchBox {\r\n  position: absolute;\r\n  left: 20px;\r\n  top: 20px;\r\n  width: 200px;\r\n}\r\n\r\n.searchInput {\r\n  width: 100%;\r\n  height: 30px;\r\n}\r\n\r\n.searchInput input,\r\n.posInput input {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 0 10px;\r\n}\r\n\r\n.searchList {\r\n  position: absolute;\r\n  left: 0px;\r\n  top: 35px;\r\n  width: 100%;\r\n  background-color: #fff;\r\n}\r\n\r\n.searchList .searchItem {\r\n  width: 100%;\r\n  height: 30px;\r\n  line-height: 30px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  padding: 0 10px;\r\n  cursor: pointer;\r\n}\r\n\r\n.searchList .searchItem:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.posInput {\r\n  position: absolute;\r\n  right: 20px;\r\n  top: 20px;\r\n  width: 300px;\r\n  height: 30px;\r\n}\r\n\r\n.backCenterBtn {\r\n  position: absolute;\r\n  right: 20px;\r\n  bottom: 20px;\r\n  width: 50px;\r\n  height: 50px;\r\n  background-image: url(\"./assets/location.png\");\r\n  background-size: cover;\r\n  cursor: pointer;\r\n}\r\n\r\n.scaleBtnBox {\r\n  position: absolute;\r\n  right: 30px;\r\n  bottom: 80px;\r\n  width: 29px;\r\n  height: 73px;\r\n  padding: 0 2px;\r\n  background: #fff;\r\n  border-radius: 3px;\r\n}\r\n\r\n.scaleBtn {\r\n  width: 24px;\r\n  height: 36px;\r\n  margin: 0 auto;\r\n  background: url(\"./assets/scale.png\") no-repeat;\r\n  cursor: pointer;\r\n}\r\n\r\n.scaleBtn.in {\r\n  background-position: -3px 3px;\r\n  border-bottom: 1px #dfdfdf solid;\r\n}\r\n\r\n.scaleBtn.out {\r\n  background-position: -3px -156px;\r\n}\r\n\r\n.scaleBtn.disabled {\r\n  opacity: 0.2;\r\n}\r\n\r\n.overlay {\r\n  position: absolute;\r\n  transform: translate(-50%, -50%);\r\n}\r\n</style>\r\n","import { render } from \"./New.vue?vue&type=template&id=01981d5b&scoped=true\"\nimport script from \"./New.vue?vue&type=script&lang=js\"\nexport * from \"./New.vue?vue&type=script&lang=js\"\n\nimport \"./New.vue?vue&type=style&index=0&id=01981d5b&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\works\\\\学习\\\\web_map_demo\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-01981d5b\"]])\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=7fb52170&scoped=true\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=7fb52170&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\works\\\\学习\\\\web_map_demo\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7fb52170\"]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Old.vue?vue&type=style&index=0&id=7f5862c5&scoped=true&lang=css\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHqADAAQAAAABAAAAHgAAAADKQTcFAAAE0klEQVRIDbVXa0ybVRg+/XpjFAqVjUGalkI6cBmORW5OgzK5zSxBQ8xCRiLzEn/oiFlYjAlZvJJsZj+8ZGg2cQuZmwvOIeMmLGTiBVGkBkcGjnVFzJhcNihU6Ffa+j4fnKW4WsuAJ3nznfOd93uf856e856nMuYfAr2Wk4WQaTUazX0VbxzZsS0jpyg6OjpJE6rWRoar1Ph0clp0zjjmpkdHRwd6OlvrDr3zWrvD4RinITvZHJmbzEP2vwDhOrKYxMTE9Nqm7lrbXy5xfMrjDcbge/ZC15dms/khxFiMhZhLIFvSW8gylN5Ff3Si/oW8/IL9kWFKKbOR2x728+8e1mvzsHG7l92e9kqf6sJlbL1WxraaBJaeKLBYHRaL0bgotjQ1fFD24tPHqTtC9jcZspfgS4xZaVQqlf6LZsv7D6dtzoOH9aaHfXZpnl0eCmq1WHKcwEqyFSwhZmECl763dOx5anuZKIo2Cucgk8g5MUhDQdrWOXR+i3nj/R5K6ORFF/u6584kySV4FDwoZ3tzlUwghl+vDFufyDIXuVwuK0WQMgchpobljDnf2ns0NdmU6XB62eFaF+vsDy5L+vYuXBvxsv5hD0uj5TfGROhSMgtSzp355BtynCbzgFhBpqPf9KWdOY+UIlOQ9v1x76QUT8LYlJcN3vCyrGQ5M5v0hoj1RmV7a/0vNOhAtiG0ew3YSPDG8q4GKWIBiIWYwO7ikr16vf4BampArK187/Sr2L3YSPf6myLwfwExEVsXrlK9fri6nPw2CCgO6akpT+Ij7N61Ao+dn/t4llqtTlSgIoWFyJU3bnkCHpnKZ1QsMwlbIjh0DbhZRY14xxnHEbUgVqdQlD7/cr6AMojR7quBN9NySBHPnz8KELCjYHe2ArUXHVQkjn9nl1sxy4dW9ARHYSZjcaZ4g4CCj2gogxz+ZsvHVvLkHJHasHUKfsvw2usb2DdT37avD29frMS9EhicI1KrVqF4LIAXT96nJw8GUt72GV5+c5HDS4sr4D5FBF2YH+blhw74BeeYmnaKAi5xeONq48BRWAtwjkn7zKwCyiFeH7ER9+lvizvb9/yt5gTAAdiuXxsWIFfQSdu08BJtf1juKvzYf/eqQSgAbY1nOmVUMrf2WSe7Ub3e/lwMWL38TSjYdxAIB4tVbGZ2fn6TQbNPIGE20fVTTwMCQDmsFXjspuaWLhIEY8jdXrG/5F1oJMgVKIfVxs5UuSSFbtmdroMHnj1L8a0gnhscHLQ1N174EISQK1uMgX9v+AULxCrNUUru1ceOfjUxMTFEHRtPb765oXYw49HClHhjbBzkCpQDFMRKANLyIiVTK2SssbXDcmDfnhqK10M2xg8vJgCxZ2rquFq3bbMhYTXFXnevdXhXdtKbbrfbQjxXyOY4MbWlfw4apVKZUHPu26q8xzK24+VK5S0yfa44p4pI+yhcLxlUpteXmPoSOQS9ofJI9SvQSJArGIBQwJ0drKDHRvr0eFXdobfKcWIukw2QSaT09AssO64aIwmzXcdOtbTbboquYP6+wAe+VSfqv4uKiiqjGIVk5sV4S5Jc0iEHDmxrTEBDtgEaCXIFygGXOO5TXG1wnrQ7RdRe23Xrn22Np384dfJjC84pDVnJbGT49wAxt2Sn/gPvDUS1Og7cLAAAAABJRU5ErkJggg==\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./App.vue?vue&type=style&index=0&id=7fb52170&scoped=true&lang=css\"","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./New.vue?vue&type=style&index=0&id=01981d5b&scoped=true&lang=css\""],"sourceRoot":""}